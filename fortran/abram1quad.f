c
c
c
c
c
ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
c
c
c        this is the end of the debugging code and the beginning of the
c        Abramowitz function code proper.
c
c
ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
c
c
        subroutine abram1(z,j1,ifexpon)
        implicit real *8 (a-h,o-z)
        complex *16 z,j1,j1u,com,zu,ima
        real *8 rea(2)
        equivalence (rea(1),com)
        data ima/(0.0d0,1.0d0)/,
     $     pi/3.141592653589793238462643383279502884197d0/
c
c        this subroutine evaluates the Abramowitz function J_1
c        for a user-specified complex number z with Re(z)>=0.
c        
c        The code is reasonably accurate (32-digit relative accuracy
c        when ifexpon=0) 
c        and reasonably fast (O(1) cost for any z).
c
c
c        When ifexpon=1, that is, the Abramowitz function is evaluated
c        honestly. The subroutine will lose accuracy gradually
c        simply due to the ill-conditioning of evaluating the 
c        exponential factor exp(-nu) with nu=3(z/2)**(2/3).
c        The condition number of evaluating exp(-nu) is abs(nu). 
c        Thus, the subroutine will lose an extra log_{10}abs(nu) 
c        digits if the function is evaluated honestly.
c        
c                      input parameters:
c
c  z - the complex number for which the Abramowitz function
c        J_1 is to be evaluated
c
c  ifexpon - the integer parameter telling the subroutine whether
c        to calculate the actual values of the Abramowitz function,
c        or the values of the Abramowitz function scaled by e^{nu}.
c        Permitted values: 0 and 1. 
c    ifexpon = 1 will cause the subroutine to evaluate the Abramowitz 
c        function honestly
c    ifexpon = 0 will cause the subroutine to scale the Abramowitz 
c        function by e^{nu}, where nu=3(z/2)^(2/3).
c        
c     
c                      output parameters:
c
c  j1 - the said Abramowitz function
c        
c       
c        . . . if z in the upper half-plane - act accordingly
c
        com=z 
        if(rea(2) .lt. 0) goto 1400
        call abram1ur(z,ier,j1,ifexpon)
        return
 1400 continue
c
c       z is in the right lower quadrant. compute 
c       j1 at the points zu obtained from z by reflection
c       in the x axis.
c
        zu=dconjg(z)
c
        call abram1ur(zu,ier,j1u,ifexpon)
        j1=dconjg(j1u)

        return
        end
c
c
c
c
c
        subroutine abram1p(p,m,z,f)
        implicit real *8 (a-h,o-z)
        complex *16 p(1),z,f
c
c       evaluate a polynomial at a point
c
        f=p(m)
        do 1200 i=m-1,1,-1
        f=f*z+p(i)
 1200 continue
        return
        end
c
c
c
c
c
        subroutine abram1pr(p,m,z,f)
        implicit real *8 (a-h,o-z)
        real *8 p(1),z,f
c
c       evaluate a polynomial at a point
c
        f=p(m)
        do 1200 i=m-1,1,-1
        f=f*z+p(i)
 1200 continue
        return
        end
c
c
c
c
c
        subroutine abram1pc(p,m,z,f)
        implicit real *8 (a-h,o-z)
        real *8 p(1)
        complex *16 z,f
c
c       evaluate a polynomial at a point
c
        f=p(m)
        do 1200 i=m-1,1,-1
        f=f*z+p(i)
 1200 continue
        return
        end
c
c
c
c
c
        subroutine abram1asym(z,j1,ifexpon)
c
c        evaluate the asymptotic expansion for J_1 at
c        the user-supplied point z.
c
        implicit real *8 (a-h,o-z)
        dimension c(51)
        complex *16 z,j1,nu,pp,cd
        data ima/(0.0d0,1.0d0)/,
     $     dc/1.0233267079464884884795516248892648607073764377510d0/,
     1     toth/0.66666666666666666666666666666666666666666666666667d0/
c
         data c/
     1     +1.0000000000000000000000000000000000000000000000000D0,
     2     +4.1666666666666666666666666666666666666666666666667D-1,
     3     -1.2152777777777777777777777777777777777777777777778D-1,
     4     +6.4139660493827160493827160493827160493827160493827D-2,
     5     +1.9340358153292181069958847736625514403292181069959D-2,
     6     -3.1092849124442729766803840877914951989026063100137D-1,
     7     +1.4108298810003298372961438805060204237158969669258D0,
     8     -5.3827622941806961630912462531118223847990651831530D0,
     9     +1.8161730583219714414179259492116716625175701536012D1,
     *     -4.5968409978561843180663715810919431006138655717819D1,
     1     -1.7270545637282574541539218028437527506450491316168D1,
     2     +1.5336912918879044875645393979400782114013980298290D3,
     3     -1.6190694089834720374200453438533315379038914388702D4,
     4     +1.2687686099818026157207128529588081834801628826122D5,
     5     -8.0997125989332100952887618389405908052786348486163D5,
     6     +3.6692432044524805606008342057402872691755552044046D6,
     7     +1.4384983107987170865939159179206964186206992839197D6,
     8     -3.1508125311373187886944666410649909254752880140110D8,
     9     +5.2192299842860676636239173647916505227088106453736D9,
     *     -6.1817769280508239681161560778902708397488432553194D10,
     1     +5.8032347312981415374577000998690618853710036680704D11,
     2     -3.7892351932652463391086949853150336431595969167889D12,
     3     -1.5123025253905347120351977060888493525523738506803D12,
     4     +6.1527527610446096883366507134161806264508407189285D14,
     5     -1.3886178332821098784826706219359021625603371120420D16,
     6     +2.2007230298938031864489959706263945901908341510521D17,
     7     -2.7266084811723899263202218887586266388439271930160D18,
     8     +2.3255711520137258834079732454567070305431630066602D19,
     9     +9.3727283501642472569850049440958922525964632105633D18,
     *     -6.1133852852281248233116724653523686848000251647100D21,
     1     +1.7467015512923958915108040588865599274769969362688D23,
     2     -3.4673402787339831445293963790202874212018370199292D24,
     3     +5.3365157771135460626377847551795657101745782873191D25,
     4     -5.6187833957835259641463540127476343033674944151590D26,
     5     -2.2785459569143472345576162596960244607897932740114D26,
     6     +2.1765941575412984900178913815414096374265901134979D29,
     7     -7.5252703244449870706649728455051719264774557416455D30,
     8     +1.7949627333178391336288802851398801952235561144434D32,
     9     -3.3012269437034906294403340673892439762448219918145D33,
     *     +4.1360306659267612014949229673903739588484075570275D34,
     1     +1.6843863559908663584117324102266963902760366902022D34,
     2     -2.2164129694951982299835628913717183949566827840614D37,
     3     +8.9930830768257291392389483460965808342700917846354D38,
     4     -2.5049044535318971544142401064687852502565727841999D40,
     5     +5.3585430255038862145603879281648325885966067013105D41,
     6     -7.7852354443222646802866236018512890620148507504024D42,
     7     -3.1803442524280829603589621712693990568285023643522D42,
     8     +5.5149052675957277411571412007598914840860113921683D45,
     9     -2.5686200458047391739621385174294378208758452500768D47,
     *     +8.1822342396534148639247216473386176595552928241198D48,
     1     -1.9958636618513235881941711559552488705873255035002D50/
c
        m=34
        nu=3*((z/2)**toth)

        pp=c(m+1)
        cd=1/nu
c
        do 1800 i=m,1,-1
        pp=pp*cd+c(i)
 1800 continue
c 
        j1=dc*sqrt(nu/3)*pp
        if (ifexpon .eq. 1) j1=j1*exp(-nu)      
c
        return
        end
c
c
c
c
c
        subroutine abram1series(z,j1,ifexpon)
        implicit real *8 (a-h,o-z)
        dimension a(25),b(50)
        complex *16 z,j1,lnz,z2,c1,c2,nu
c
c
c        this subroutine evaluates the Abramowitz function J_1
c        for a user-specified complex number z in the local regime,
c        i. e. for cdabs(z) < 1, using the series expansion 
c
c                      input parameters:
c
c  z - the complex number for which the Abramowitz function
c        J_1 is to be evaluated
c
c                      output parameters:
c
c  j1 - the said Abramowitz function
c        
        data a/
     2     -1.0000000000000000000000000000000000000000000000000D0,
     4     +8.3333333333333333333333333333333333333333333333333D-2,
     6     -1.3888888888888888888888888888888888888888888888889D-3,
     8     +8.2671957671957671957671957671957671957671957671958D-6,
     *     -2.2964432686654908877131099353321575543797766019988D-8,
     2     +3.4794594979780164965350150535335720520905706090891D-11,
     4     -3.1863182215915901982921383274116960183979584332318D-14,
     6     +1.8966179890426132132691299567926762014273562102570D-17,
     8     -7.7476225042590409038771648561792328489679583752329D-21,
     *     +2.2653866971517663461629137006372025874175316886646D-24,
     2     -4.9034344094194076756773023823316073320725794126939D-28,
     4     +8.0754848639977069757531330407305786101327065426448D-32,
     6     -1.0353185723073983302247606462475100782221418644416D-35,
     8     +1.0534377007604785614822554398122813168723462194156D-39,
     *     -8.6489137993471146262910955649612587592146651840361D-44,
     2     +5.8124420694537060660558437936567599188270599355081D-48,
     4     -3.2377685324497025769027650365735070849081216218294D-52,
     6     +1.5115632737860422861357446482602740825901594873153D-56,
     8     -5.9726698031691255181592565523165563560540520282729D-61,
     *     +2.0150707837952515243452282565170568002881417099436D-65,
     2     -5.8509604639815665631394548679357049950294474737039D-70,
     4     +1.4726065800819406430935907751776162778187474765187D-74,
     6     -3.2336552043960049255458734632797898063652777262157D-79,
     8     +6.2319904494218411300221119782604644741853178504004D-84,
     *     -1.0598623213302450901398149622891946384668907908844D-88/

        data b/
     1     -1.7724538509055160272981674833411451827975494561224D0,
     2     +6.3417650264770070909023186487639635343676099609011D-1,
     3     +5.9081795030183867576605582778038172759918315204080D-1,
     4     -1.4312581966508617020196376651747747389750786078529D-1,
     5     -1.9693931676727955858868527592679390919972771734693D-2,
     6     +3.2419118092329176515142109234394393797732791612363D-3,
     7     +1.8756125406407577008446216754932753257116925461613D-4,
     8     -2.2889387501417908671459620324075776101573121739533D-5,
     9     -7.4429069073045940509707209344971243083797323260367D-7,
     *     +7.1300232934730979571090231516188018728812920633199D-8,
     1     +1.5036175570312311214082264514135604663393398638458D-9,
     2     -1.1757281003950180216639183145921785476226795975099D-10,
     3     -1.7524680151879150599163478454703501938686944800068D-12,
     4     +1.1504962924920194630775727236956908945862160676471D-13,
     5     +1.2838593517860183589130753446669232189514245274775D-15,
     6     -7.2286447543021162402663238288071671581804641186473D-17,
     7     -6.2934281950295017593778203169947216615265908209681D-19,
     8     +3.0899169970328973494298223313234182763646963710355D-20,
     9     +2.1649219797143108907388442782919579159018200278528D-22,
     *     -9.3932000507275085051381168494967571238128211561177D-24,
     1     -5.4258696233441375707740458102555336238140852828391D-26,
     2     +2.1033153820757860070347157006426139325677096656487D-27,
     3     +1.0212440473073852005974112196980112222499689973347D-29,
     4     -3.5694235458618047156660705626739252650626845002171D-31,
     5     -1.4800638366773698559382771299971177134057521700502D-33,
     6     +4.7005549949833435118052956861888678966565374268145D-35,
     7     +1.6866824349599656477929084102531255993227944957837D-37,
     8     -4.8999753110261129615133355776967340706050924588895D-39,
     9     -1.5386630495894596312651965063429352301795242617987D-41,
     *     +4.1125107668603284704030100925869421539891538479969D-43,
     1     +1.1410182051089800750946952216113720653908225893947D-45,
     2     -2.8200726190061534776981685494983441293141477027336D-47,
     3     -6.9710300898642477706176394282219700964737450476214D-50,
     4     +1.6003483618209988417886534662130066287938376386018D-51,
     5     +3.5503081690166782636198825710323249791055487892138D-54,
     6     -7.6009140016827658197244028730230992702661945302700D-56,
     7     -1.5230837275918825669754965984694658855021659327387D-58,
     8     +3.0518148066784526499969228742066374949644318865222D-60,
     9     +5.5552530458908070429860911057718418700155594439168D-63,
     *     -1.0451344707344204916556132020033034954719987850628D-64,
     1     -1.7371022657569753105022173564014514915620886316188D-67,
     2     +3.0774818294544657983777229028030470608724390886875D-69,
     3     +4.6919543682493998609032692013112159780733290970985D-72,
     4     -7.8483771517168479120374211592638738554725484652455D-74,
     5     -1.1021739178410617479218391358494752121384376549444D-76,
     6     +1.7449677778380225256096287519419589529845985836168D-78,
     7     +2.2657496512304692114746410439911094914964285228583D-81,
     8     -3.4027412160749250024541165759442180692791677105595D-83,
     9     -4.0992720567927145959520933637123850982349625902054D-86,
     *     +5.8518824120170529390306995114562108302897286529580D-88/

c
c        evaluate j1
c
        m=27
        c1=b(m)
        do k=m-1,1,-1
           c1=c1*z+b(k)
        enddo

        m2=14
        c2=a(m2)
        z2=z**2
        do k=m2-1,1,-1
           c2=c2*z2+a(k)
        enddo

        j1=(c1*z+1+c2*z2*log(z))/2
        if (ifexpon .eq. 1) return

        nu=3*(z/2)**(2.0d0/3)
        j1=j1*exp(nu)        
c
        return
        end
c
c
c
c
c
        subroutine abram1ur(z,ier,j1,ifexpon)
        implicit real *8 (a-h,o-z)
        complex *16 z,com,ima,cd,j1,nu
        dimension rea(2)
        equivalence (rea(1),com)
        real *8 c1p0(126)
        real *8 c1p1(96)
        real *8 c1p2(76)
        real *8 c1p3(68)
        real *8 c1p4(64)
        real *8 c1p5(60)
        real *8 c1p6(60)
        data ima/(0.0d0,1.0d0)/,
     $     dc/1.0233267079464884884795516248892648607073764377510d0/,
     1     toth/0.66666666666666666666666666666666666666666666666667d0/
c
c        this subroutine evaluates the Abramowitz function J_1
c        for a user-specified complex number z in the upper right quadrant.
c        it is reasonably accurate (32-digit relative accuracy) 
c        and reasonably fast.
c        
c
c                      input parameters:
c
c  z - the complex number for which the Abramowitz function
c        J_1 is to be evaluated
c
c                      output parameters:
c
c  ier - error return code. 
c         ier=0 means successful conclusion
c         ier=4 means that z is not in the upper right quadrant
c  J1 - the said Abramowitz function
c        


c  rsmall=0.99902E+00, rlarge=0.50010E+01, iback= 27, m=  63 relerr=0.1519E-32
        data c1p0/
     1     0.4692534405232096185969345453113635D-34,
     2     -.4467086230213365737830444315170479D-35,
     3     -.8608033622368805709327430154217934D-32,
     4     -.3953889011584709254069031723078780D-32,
     5     0.5412075161429045903567450058111968D-30,
     6     0.7662913366556850802143313576302414D-30,
     7     -.5476587168732188559949046217032589D-29,
     8     -.6078784233469132797032065799089134D-28,
     9     -.1236203256320582582832116430328640D-26,
     *     0.2660547757741886680170839783420963D-26,
     1     0.9098028784742101957296359149361582D-25,
     2     -.6376554342205314147650466574290119D-25,
     3     -.3439008118972147261960399704198183D-23,
     4     0.3003892800981664304131578596327238D-24,
     5     0.8200523772015744194739096042903466D-22,
     6     0.3827318766544469128715876019234825D-22,
     7     -.1171529616782493270486956539452145D-20,
     8     -.1673398286312353162179430272880001D-20,
     9     0.3542623701560494152111179960747594D-20,
     *     0.4016617993511961477282051156530417D-19,
     1     0.2964156085458151431689202479841679D-18,
     2     -.6391736172149415647184273559661861D-18,
     3     -.8988145649235575118526022659816016D-17,
     4     0.6350326175325298153727546289603918D-17,
     5     0.1542200704459868562390022279243242D-15,
     6     -.1461096422833060335462193499964940D-16,
     7     -.1802222349022251313383170350438560D-14,
     8     -.8160301624498183766610861269526801D-15,
     9     0.1352982180687516659619175882544175D-13,
     *     0.1866705818913272137094672179807013D-13,
     1     -.2707771151121029837262037660700896D-13,
     2     -.2448726793613131817427870376394327D-12,
     3     -.9558485891263226745379371208419215D-12,
     4     0.2228197947534727198803226482825269D-11,
     5     0.1753032372237834416447526847329358D-10,
     6     -.1338770231664526924528381943850493D-10,
     7     -.1842766021871711032112333796627872D-09,
     8     0.2620721091960687838744231823154197D-10,
     9     0.1364061477537022534350009019841637D-08,
     *     0.5239469609084960572415625789593866D-09,
     1     -.6891188834071455819233706803049895D-08,
     2     -.8187528965594099998615614700534506D-08,
     3     0.1453300933659372222167173522716495D-07,
     4     0.7184441379936076318245622544047550D-07,
     5     0.1368563656651036868450321890700122D-06,
     6     -.4502986178187220745429509983356651D-06,
     7     -.2002519131375547633085187624304464D-05,
     8     0.2012180639868065292553973949194804D-05,
     9     0.1535937278341589650111639065123087D-04,
     *     -.4890181249797331479294866012281380D-05,
     1     -.8520417572288430775074567022139008D-04,
     2     -.1382195768394289359198308086709015D-04,
     3     0.1000356266035156667876660086921574D+01,
     4     0.2525247435629457108901106910487478D-03,
     5     0.4156367975355100212992711462013252D+00,
     6     -.1818928938920948751334825306866182D-02,
     7     -.1206047749147169772581290720241899D+00,
     8     0.9433045969735120895114701812943434D-02,
     9     0.7590967148774850680694486384591176D-01,
     *     -.3901011729124636654771743573050220D-01,
     1     -.8110602972655591815489130320475010D-01,
     2     0.1323083221861208764243878967350177D+00,
     3     0.2157800801256257428270210061638837D+00,
     4     -.3665073720287864036670372538469542D+00,
     5     -.7911974541316051343213118388533455D+00,
     6     0.7952666965891257879477042480090552D+00,
     7     0.2522389863168413088441011252267067D+01,
     8     -.1156641646480916776998721067528505D+01,
     9     -.6475916612479221050778892374108534D+01,
     *     0.1167152761653245245658386797575485D+00,
     1     0.1302662946088009924403224284015767D+02,
     2     0.5906519221570852229368818460618027D+01,
     3     -.1880881266215624410040015292798476D+02,
     4     -.2322561607234981388392134908668426D+02,
     5     0.1184126684050725132337937294677131D+02,
     6     0.5782600039572469297411701535491079D+02,
     7     0.3115558262278946470975589854322189D+02,
     8     -.1055153964347988893238479373416701D+03,
     9     -.1364085316672077024613904405301714D+03,
     *     0.1368026406714526642858580228410930D+03,
     1     0.3062051312157396221057826591189970D+03,
     2     -.8939815032458703798036291024277609D+02,
     3     -.4820085873509335516222354750421766D+03,
     4     -.1094885657185093842262067037204619D+03,
     5     0.5323560428984753937035896606081031D+03,
     6     0.4807129618357433258443123781550037D+03,
     7     -.3080292539797637225492569152713638D+03,
     8     -.9225169911144438637347794121142979D+03,
     9     -.2372511074777430045905467641676564D+03,
     *     0.1206158650017694340310231997600116D+04,
     1     0.9444691397437100019605527455255189D+03,
     2     -.1092880204869661365491857212416017D+04,
     3     -.1484275117627613175866606843765010D+04,
     4     0.5217334795409706479561120054490720D+03,
     5     0.1556732187886877167791230709591942D+04,
     6     0.2888169351280082113229485304573686D+03,
     7     -.1116077309445411800556438566282567D+04,
     8     -.9516365437452180194730043119896700D+03,
     9     0.4167622734567917096623839543011266D+03,
     *     0.1173645120144243502934998585067367D+04,
     1     0.1756819142322719245313569209223214D+03,
     2     -.9485595329349054741336973045173301D+03,
     3     -.4408289178180532317433675525606163D+03,
     4     0.5147969777168311490490737394337703D+03,
     5     0.4048600157847237197542675970914350D+03,
     6     -.1418807802801911115967081967550683D+03,
     7     -.2383776008236406545069504619404448D+03,
     8     -.4559134477187289394980231588347613D+02,
     9     0.9172686491765358270277024052037198D+02,
     *     0.7970860359647126218372344668600782D+02,
     1     -.1717115635996124269266413301117030D+02,
     2     -.5035567522229203886714725047719855D+02,
     3     -.3952369158117744124143055923354632D+01,
     4     0.1966075435824875741080151454979964D+02,
     5     0.4231782083181592030263789680272510D+01,
     6     -.4770660613645163527122941225482916D+01,
     7     -.1580412275562758342489048654779637D+01,
     8     0.5198679347543113123928845546484503D+00,
     9     0.3344647168343495545431833120848479D+00,
     *     0.7119057475461625275384277433523435D-01,
     1     -.3843976365615872950821737594726866D-01,
     2     -.3491075597028242075923464131426544D-01,
     3     0.1559437468347882471684532662591123D-02,
     4     0.4939390291054706088888635656503619D-02,
     5     0.5603406394648251493200600399811380D-04,
     6     -.2483831674473944720101099215728516D-03/



c  rsmall=0.49990E+01, rlarge=0.10001E+02, iback=  2, m=  48 relerr=0.3769E-33
        data c1p1/
     1     -.9903198054053318803043185539377082D-18,
     2     0.7150165600838453407766431497439653D-18,
     3     0.1000000000000000358272795382305263D+01,
     4     -.3188818679698493216472236324846036D-16,
     5     0.4166666666666196655655336447898299D+00,
     6     -.2261299322549380310092828743959443D-13,
     7     -.1215277777750367299792636413551016D+00,
     8     0.4140053076212508917805981627979638D-11,
     9     0.6413966047733120788205983764874294D-01,
     *     -.3486459392306659949109039612100523D-09,
     1     0.1934034906276251562083808955898556D-01,
     2     0.1705116679372312573671218634400404D-07,
     3     -.3109277409258251650354318016244098D+00,
     4     -.4548211430304169301533992148188387D-06,
     5     0.1410796280221364595544800817634889D+01,
     6     0.3567863838012877325491246885073754D-06,
     7     -.5381801663786286043144477050547477D+01,
     8     0.5514815345013846394571174495739258D-03,
     9     0.1814583351383789491900631740139927D+02,
     *     -.2767177403538360294438334065563671D-01,
     1     -.4597005945621647708641854748767161D+02,
     2     0.8131816005400191123692676924214298D+00,
     3     -.8088834376930517704198943415468557D+01,
     4     -.1605736859035498461112429403237120D+02,
     5     0.1209495867984003381294380961042006D+04,
     6     0.1950288565966498204818540289429806D+03,
     7     -.9198797772520998669416839615954911D+04,
     8     -.2879405176991447965852808873710834D+03,
     9     0.2093450850543863350951020687929918D+05,
     *     -.5090526314369547604499434897936137D+05,
     1     0.2742166385659980802647685480403711D+06,
     2     0.1434139237293037707601781686141574D+07,
     3     -.1011043047155095655939424462950472D+07,
     4     -.2463756800291049556515307467518959D+08,
     5     -.7849609912932646401914946517789464D+08,
     6     0.3087725961088875417287567374820289D+09,
     7     0.1985883721704424855274286457971260D+10,
     8     -.2884919130349810035046784816146722D+10,
     9     -.2867361832876669447013987759241313D+11,
     *     0.1854114021208663202132085093796233D+11,
     1     0.2975920194004170870387827777358084D+12,
     2     -.4552195830958029930750921315499745D+11,
     3     -.2322823985830140557480926809503383D+13,
     4     -.6970249713496414341324905198678128D+12,
     5     0.1312337891464219709454344277858326D+14,
     6     0.1225073023572162620451554355052744D+14,
     7     -.4175131809851610642339471144245988D+14,
     8     -.1152012582218696093887773681747349D+15,
     9     -.1034111398531724861615451784429674D+15,
     *     0.7655274118881494550440126083153719D+15,
     1     0.2630559167109798871057542230396253D+16,
     2     -.3653209504048206492010198924014276D+16,
     3     -.2183221019612595945737502386129494D+17,
     4     0.1056512987563421620310892055535743D+17,
     5     0.1206062406532207108950405849148839D+18,
     6     0.6071493967329301967607735933103141D+16,
     7     -.4717188076159327036516974443183099D+18,
     8     -.2926631067923034055418776382425546D+18,
     9     0.1143178784109774326263762657478669D+19,
     *     0.2056834081590443894322256339805022D+19,
     1     0.3244744025407970178283427268399857D+17,
     2     -.9182387139494689697312678283826425D+19,
     3     -.1625329264418793141508247401938143D+20,
     4     0.2862189199898139040448102654698489D+20,
     5     0.9273657114028368157971595436220686D+20,
     6     -.5555307893145288468999841975007674D+20,
     7     -.3242190330668021761906746977975317D+21,
     8     0.7684482458212729074472474694215937D+19,
     9     0.7798256145607078485998486483341500D+21,
     *     0.4194142626497384806938119057713450D+21,
     1     -.1162257768149573116156568975808854D+22,
     2     -.1856834409672887264551848968745735D+22,
     3     0.1975221394434086394455827296426676D+21,
     4     0.4881034438425869022107933648535634D+22,
     5     0.4497269626755428674044367940020779D+22,
     6     -.8659652804310132253821293392126652D+22,
     7     -.1456920497832611986830735996502456D+23,
     8     0.9376589405988255666140536871629915D+22,
     9     0.2705284617378670215447412573661661D+23,
     *     -.1394492602592957978891913517305115D+22,
     1     -.3287297251934218735465313180810744D+23,
     2     -.1666473261695113413874487421914045D+23,
     3     0.2357645988147347844803779182589393D+23,
     4     0.3593437242112806480393647945187228D+23,
     5     -.2502352942221332687377612954349311D+22,
     6     -.4202763328699009836143171814379123D+23,
     7     -.1501922087938088793514549411093340D+23,
     8     0.3017118338023470567157128266768326D+23,
     9     0.1762586058970847144463198221729561D+23,
     *     -.1173553101281079132283025058382642D+23,
     1     -.9773309693827080933090884661178736D+22,
     2     0.6440158678456463186378737622776401D+21,
     3     0.2663127410278454241131149927168465D+22,
     4     0.1305869939144111881964078820293502D+22,
     5     -.2466424562892136065740100588550586D+21,
     6     -.3658859199097160443644883082730892D+21/



c  rsmall=0.99990E+01, rlarge=0.20001E+02, iback=  1, m=  38 relerr=0.9069E-33
        data c1p2/
     1     0.1000000000000000000288209232681961D+01,
     2     -.4890600790387663388844604081437180D-19,
     3     0.4166666666666665627070315496855543D+00,
     4     -.3644355379741089792315196229576832D-16,
     5     -.1215277777777642197992089511084182D+00,
     6     0.1514749855825778376964751945004621D-13,
     7     0.6413966049327275883621104133931168D-01,
     8     -.2383986386397064716766343723267328D-11,
     9     0.1934035809546266160403194908634362D-01,
     *     0.2082610109278230652365613069422892D-09,
     1     -.3109284808831680100875050345254226D+00,
     2     -.1073652282097776221669140972548383D-07,
     3     0.1410829082748611219876126922766429D+01,
     4     0.2551896147740845947557399462306409D-06,
     5     -.5382723578731837223860641535423248D+01,
     6     0.7079749086831627595239500489074555D-05,
     7     0.1816049229666649918587749754805453D+02,
     8     -.9751857987076811824358935549326456D-03,
     9     -.4594602349251660702540880484207877D+02,
     *     0.4982793052054199624381885424419097D-01,
     1     -.1718180192836002020670963539169634D+02,
     2     -.1654548847431634419982485750279061D+01,
     3     0.1511536164148262578944010803655798D+04,
     4     0.3844740261794280504398476676639897D+02,
     5     -.1531097576817606827139063341635184D+05,
     6     -.5848903523960006541802407489436168D+03,
     7     0.1046074012674795794353507251388220D+06,
     8     0.3022919437133343549274280545538745D+04,
     9     -.4010040380459610650647348310879420D+06,
     *     0.1290241988503311008118673144618526D+06,
     1     -.1800630520949473526942736525665586D+07,
     2     -.4920221000542156648738832401805405D+07,
     3     0.4853877650659929674670432879670731D+08,
     4     0.1033454365031524638345577528340411D+09,
     5     -.3726956302456051003708306979871989D+09,
     6     -.1574537733316012393422378794917177D+10,
     7     -.1141923295779918002740519723200577D+10,
     8     0.1849683435219567549219349761333588D+11,
     9     0.7217915025840868091462602911806449D+11,
     *     -.1684056569506785732082560718347639D+12,
     1     -.1130436858902830746449563095233194D+13,
     2     0.1137659025915948198399403123242536D+13,
     3     0.1164251858868586711476597869924470D+14,
     4     -.4728864990268820137772663688279453D+13,
     5     -.8848178151486875015187879576448245D+14,
     6     -.3250040956324446676835912912800186D+13,
     7     0.4995311035686750996679226373043045D+15,
     8     0.2568312017653076089833887198222298D+15,
     9     -.1927269389729080105808498802088254D+16,
     *     -.2560946722841700897616339341065437D+16,
     1     0.3005045233754934864877141169394252D+16,
     2     0.1613203642787084596738429496742836D+17,
     3     0.2112293202882407706532287055920121D+17,
     4     -.7205112947812782969566102051016040D+17,
     5     -.2107172711733720630576843627151590D+18,
     6     0.2210648683938580205879741984032847D+18,
     7     0.1038453063070787449591033435497708D+19,
     8     -.3526022413925603890026174444850106D+18,
     9     -.3402309820742930185633612316156673D+19,
     *     -.5474310267801690586770194156985750D+18,
     1     0.7455487830925076632653063174802955D+19,
     2     0.5673359654401810755701227764282140D+19,
     3     -.8970491892721200024242038893553957D+19,
     4     -.1977359600219691881487570157020341D+20,
     5     -.3004888956292266965724215594980207D+19,
     6     0.4195627947576232194155765311410263D+20,
     7     0.3584535393084920481449445460240565D+20,
     8     -.5574661481980367798568950657436441D+20,
     9     -.7172112134355507604270683197529198D+20,
     *     0.3892123231203798100609022471756141D+20,
     1     0.7365654669764506970490157437137473D+20,
     2     0.5059604636493908653957024755104965D+18,
     3     -.3778709695789222815229455741207509D+20,
     4     -.2126643774900664022488717607710750D+20,
     5     0.6540363881180469707460799816488948D+19,
     6     0.1064446485166145552893730191888599D+20/



c  rsmall=0.19999E+02, rlarge=0.40001E+02, iback=  1, m=  34 relerr=0.6701E-33
        data c1p3/
     1     0.9999999999999999999999313712379206D+00,
     2     -.5688581886921245239528998127297900D-21,
     3     0.4166666666666666665520420424217632D+00,
     4     0.2824686065808387682128112654471960D-18,
     5     -.1215277777777777162674090030952562D+00,
     6     -.4984511100800977471735261057666711D-16,
     7     0.6413966049381400153588386594886687D-01,
     8     0.2370008531901001103847701001593980D-14,
     9     0.1934035815485712759319887935344433D-01,
     *     0.5237582168688744129929015445150704D-12,
     1     -.3109284913523818217796558354818678D+00,
     2     -.1162088909629287070449517336958610D-09,
     3     0.1410829884075239519380149377839409D+01,
     4     0.1196418514226702084351605188158557D-07,
     5     -.5382762101560900563113066785440997D+01,
     6     -.7773674852343980162119888527044938D-06,
     7     0.1816170105237060892581924325688062D+02,
     8     0.3271068591933575363200767570928026D-04,
     9     -.4596644753411878182933257171907880D+02,
     *     -.7130020688375493656401229389971361D-03,
     1     -.1735587549002582758854599908975278D+02,
     2     -.1161688354250171518054675637848759D-01,
     3     0.1536239529582744907180084885684590D+04,
     4     0.1796963587588638720743802347244346D+01,
     5     -.1623707755479943382735728174004593D+05,
     6     -.8831700856702701297215967835555169D+02,
     7     0.1269269373836126851537710996967598D+06,
     8     0.2833302916521088998675390388748956D+04,
     9     -.7794422035962615616644213815126118D+06,
     *     -.6490481375506906761013821697857765D+05,
     1     0.2413015842220020033302656128251500D+07,
     2     0.1024882654011617604523699330262531D+07,
     3     0.3316915490737949356165484536003221D+08,
     4     -.8120614601672554270655539016112018D+07,
     5     -.8978242877039136528949955002733377D+09,
     6     -.9816734922761276539492768330032835D+08,
     7     0.1324608059964212540854452682518800D+11,
     8     0.5071061908377555702057123362877896D+10,
     9     -.1422358460795105223332201380579075D+12,
     *     -.1084119717527838095037367027188017D+12,
     1     0.1087131704695890240919061928865901D+13,
     2     0.1598971608896025624738653306276366D+13,
     3     -.4381069812003740883633103198200783D+13,
     4     -.1776752374477189688737625985414530D+14,
     5     -.2144592213308747618128331295166494D+14,
     6     0.1510573007804947038828668575064342D+15,
     7     0.5819892465375008552780479628682829D+15,
     8     -.9574144972831204594692386186309469D+15,
     9     -.5952057591057452778522470480001014D+16,
     *     0.4083337561028967505939141747167873D+16,
     1     0.3996537510883264048947104991787541D+17,
     2     -.6582643618431748541204961388253329D+16,
     3     -.1879447619901766276037603254704032D+18,
     4     -.5543585449267876432207865813801052D+17,
     5     0.5914151363638155541329031067162200D+18,
     6     0.5473752508195106589454461766265603D+18,
     7     -.9631642348083250700220567322519893D+18,
     8     -.2590217434421053608643765182387540D+19,
     9     -.9116085831690829449500171599023000D+18,
     *     0.7637664432217250047714545751437194D+19,
     1     0.9418444324906429484152943127437588D+19,
     2     -.1378943382637159430007688451698428D+20,
     3     -.2345724029417269916292525740410551D+20,
     4     0.1240241518386723527070912631429210D+20,
     5     0.2745351811492868504418175206945669D+20,
     6     0.7861529499655041239937864660291598D+17,
     7     -.1221313206144807360425650751957746D+20,
     8     -.6601346755658037938445918147606025D+19/

c  rsmall=0.39999E+02, rlarge=0.80001E+02, iback=  1, m=  32 relerr=0.2797E-33
        data c1p4/
     1     0.1000000000000000000000012432624489D+01,
     2     -.1096217810685694050352090379829748D-22,
     3     0.4166666666666666666544210778214915D+00,
     4     0.2456427193373058372197776896518019D-20,
     5     -.1215277777777777734391526646613898D+00,
     6     0.1470766346082671678468958293346566D-17,
     7     0.6413966049382644310893920818227011D-01,
     8     -.8196008179560978703722559412238331D-15,
     9     0.1934035815332851062724487134038408D-01,
     *     0.1850603691904832402926168343021889D-12,
     1     -.3109284912361840574973880201416899D+00,
     2     -.2394978208830156147921954037673659D-10,
     3     0.1410829878925839613994029683292174D+01,
     4     0.1796723410734085109621807600158933D-08,
     5     -.5382762052166661909596249400232428D+01,
     6     -.4604501894567748934803907273198411D-07,
     7     0.1816171296865650789440250138088050D+02,
     8     -.6191015709832287988282749772786830D-05,
     9     -.4596762350445324991908315009689987D+02,
     *     0.9214055358934926666409110076930371D-03,
     1     -.1728271989836024932577911467497152D+02,
     2     -.6689669729448284640163397182035846D-01,
     3     0.1532560070419758592861432995705625D+04,
     4     0.3129600192307906173865138546896455D+01,
     5     -.1608112991150457738835248099382064D+05,
     6     -.9167190380255589904611245957891995D+02,
     7     0.1215508820466467720174169365518455D+06,
     8     0.9090802033699849810682232590665340D+03,
     9     -.6408940679276084961812525693015459D+06,
     *     0.6347064618473378478265328033751570D+05,
     1     0.2959521570239196138956676011308358D+06,
     2     -.4146994483689102577938029583508907D+07,
     3     0.2285616443203789537409729870303009D+08,
     4     0.1386222521322603037865637799294393D+09,
     5     0.8869568201809406544046291663221547D+09,
     6     -.3033434200255853274177654334733398D+10,
     7     -.4782967653561200004463162147101833D+11,
     8     0.4131519333054088898899779939261047D+11,
     9     0.1153632156131269255319624141056112D+13,
     *     -.1567790209490730771237837931829665D+12,
     1     -.1751896426540492070783726984720962D+14,
     2     -.7802936336603349593840226057923899D+13,
     3     0.1596826294445277660898880421905033D+15,
     4     0.2259306721279541646847110457373022D+15,
     5     -.3034241036487091852834736300892058D+15,
     6     -.3445903799661654644099338864097958D+16,
     7     -.1570551143738266106472479701002102D+17,
     8     0.3372422308776995941181338035329540D+17,
     9     0.2790325511500408302245074321289783D+18,
     *     -.1960050211747589657398435243073146D+18,
     1     -.2619823799065356488333357032241221D+19,
     2     0.2353948611876999761010048248446038D+18,
     3     0.1521775664465544458398234076825351D+20,
     4     0.7049184055022117991854768937041913D+19,
     5     -.4953315858687808240294192394374470D+20,
     6     -.7044995607797293994842632624976540D+20,
     7     0.3004164307747664414340883902566728D+20,
     8     0.3412434763980284161197925669846557D+21,
     9     0.4203093843290101578575814283603725D+21,
     *     -.8976532073485252368970956052718216D+21,
     1     -.1525845240083693365483429832455976D+22,
     2     0.1058542835979035180149702900476536D+22,
     3     0.1686673783887039300075675914891784D+22,
     4     -.1344855614578124837491065429043594D+21/


c  rsmall=0.79999E+02, rlarge=0.16000E+03, iback=  1, m=  30 relerr=0.7656E-33
        data c1p5/
     1     0.1000000000000000000000000922224178D+01,
     2     -.2887848199095589534044306776860404D-24,
     3     0.4166666666666666666655867873984850D+00,
     4     -.2321177853102341234627332109836900D-21,
     5     -.1215277777777777773208500733296452D+00,
     6     0.4082079202421887994159406239494355D-18,
     7     0.6413966049382709093662228207929370D-01,
     8     -.2083429225741328800022416581353687D-15,
     9     0.1934035815328087786930092435466298D-01,
     *     0.5603536697374538634157876283729262D-13,
     1     -.3109284912368250676672728778583538D+00,
     2     -.8632807244685548972632978354738108D-11,
     3     0.1410829879236063660190975698009913D+01,
     4     0.5930223723297442448103288809363699D-09,
     5     -.5382762050577474704096809818546567D+01,
     6     0.4981688310537615813417326909165424D-07,
     7     0.1816170974461831748970347441527271D+02,
     8     -.1861376242560269357267405604846062D-04,
     9     -.4596758522715835217270762930806976D+02,
     *     0.2547425070033804686932672341861209D-02,
     1     -.1722301594813605801340817441151896D+02,
     2     -.2158763674363681626302951820671331D+00,
     3     0.1522921700006539419626084862758604D+04,
     4     0.1161463384833670267233081502315870D+02,
     5     -.1524175774553063552163359463345496D+05,
     6     -.2843298866964439148757842420538914D+03,
     7     0.7417191165591798012438101926116473D+05,
     8     -.1300391393897186367345496764582334D+05,
     9     0.1055285106779075354745302341327077D+07,
     *     0.1830006207733780058260264642227475D+07,
     1     -.2477884984249285819810763277959594D+08,
     2     -.1069007640724571884060741193058775D+09,
     3     -.1119344732519669670977910605152068D+10,
     4     0.3963310058646235402831280464331458D+10,
     5     0.9744945902302634178968925587003913D+11,
     6     -.9268573196159388247292087081141201D+11,
     7     -.3761917576193393527221674577030921D+13,
     8     0.8484945456749330037547551255988100D+12,
     9     0.9177303718205016335810355375950771D+14,
     *     0.3006080872865516274277260233934596D+14,
     1     -.1377339102882503052209663954533740D+16,
     2     -.1583992123216082513124364628583638D+16,
     3     0.6911043886223337908498338027730885D+16,
     4     0.3869601255645009870012256771624087D+17,
     5     0.2228451712960630030560730928768252D+18,
     6     -.5870224978177654062448219470231578D+18,
     7     -.6626826804691071486372998293478727D+19,
     8     0.5227393371415850901216620851483873D+19,
     9     0.9296018988196399506514918736566425D+20,
     *     -.1189764920731288827416763630936181D+20,
     1     -.7665693945993229103276906339201093D+21,
     2     -.3366016278089419393812767256621013D+21,
     3     0.3341248810157283403575182231440347D+22,
     4     0.4724215820796259006994891279893776D+22,
     5     -.2140533815054048169330567078104470D+22,
     6     -.2897397832004491488831841857505300D+23,
     7     -.4259215930621443797824970149127539D+23,
     8     0.8417300106823452343050245978958275D+23,
     9     0.1260612768248050369827992670663423D+24,
     *     -.7900675761777322270793408276741796D+23/


c  rsmall=0.16000E+03, rlarge=0.32000E+03, iback=  1, m=  30 relerr=0.6169E-33
        data c1p6/
     1     0.1000000000000000000000000998678675D+01,
     2     0.1233945351186175672355673014083326D-23,
     3     0.4166666666666666666662137856990326D+00,
     4     -.2835470920041252062582628084907057D-20,
     5     -.1215277777777777786741842147374263D+00,
     6     0.2356463583757502858673040309092252D-17,
     7     0.6413966049382826798838604767379866D-01,
     8     -.9058442151262966091119740427346418D-15,
     9     0.1934035815271058625624877418611531D-01,
     *     0.9625549704253075681312345111962864D-13,
     1     -.3109284910684880143276120283446805D+00,
     2     0.6569729889325348015571735225123590D-10,
     3     0.1410829850296211814613689649193286D+01,
     4     -.3703604809605899000910255996147867D-07,
     5     -.5382760561683832535871577018451923D+01,
     6     0.1002492669128105983681751190998393D-04,
     7     0.1816235070068990137728081379881270D+02,
     8     -.1699946914209571864411902819635055D-02,
     9     -.4617825351023850506161032204774634D+02,
     *     0.1768337589414089353436893988984934D+00,
     1     0.1799550374936125131640763936202095D+02,
     2     -.6402563521324456240654591340201168D+01,
     3     -.2294934572924307485901952466657203D+04,
     4     -.1358335750823946441135480815629834D+04,
     5     0.2455179370201198949791124319480664D+06,
     6     0.3048208663121558475604104884836292D+06,
     7     -.6415431619835545316934119626006180D+07,
     8     -.3418070559206995894079194362212080D+08,
     9     -.8613915914696368481814085673112669D+09,
     *     0.2503177846832896004982279641364873D+10,
     1     0.1331281547635949155694561995783463D+12,
     2     -.1166339938977004735313502575357014D+12,
     3     -.1019782729405784350467731794788252D+14,
     4     0.2060025916611045585843614318698176D+13,
     5     0.5095919121719144241145782854190947D+15,
     6     0.1693189704256339205967162167993517D+15,
     7     -.1618806599313294737956087931570179D+17,
     8     -.1809197385479182466573644882712271D+17,
     9     0.1994745488192392927750933042839710D+18,
     *     0.9366735873067176167026241304539028D+18,
     1     0.1000935875520586133240609962546478D+20,
     2     -.3121788168673977249079298783254293D+20,
     3     -.7135254338159957717939600141239785D+21,
     4     0.6520355353529075749771084830014613D+21,
     5     0.2371189094346711525549943633165892D+23,
     6     -.5308384293894547785292979075858579D+22,
     7     -.4908482016521185555141218534231085D+24,
     8     -.1518223871492539793513586956017954D+24,
     9     0.6117178008684666983090830643002888D+25,
     *     0.6559115758956552859854512964296232D+25,
     1     -.2872520229746003403123982915740383D+26,
     2     -.1225727576086087620710039105317190D+27,
     3     -.3910465202332785719694113306708052D+27,
     4     0.1309267928944285960932258304397925D+28,
     5     0.7805033575543666843999253146754654D+28,
     6     -.7418525748842315077011733736683667D+28,
     7     -.5328552022077247394137036553886487D+29,
     8     0.1300383275675918542692811942660303D+29,
     9     0.1302919871912042015467165178926866D+30,
     *     0.3766575667067426731841500181808284D+29/
        
c     
c        if z is not in the right upper quadrant - bomb out
c
        ier=0
        com=z
        if( (rea(1) .ge. 0) .and. (rea(2) .ge. 0) ) goto 1400
        ier=4
        return
 1400 continue
c

        done=1
        thresh0=1**2
        thresh1=5**2
        thresh2=10**2
        thresh3=20**2
        thresh4=40**2
        thresh5=80**2
        thresh6=160**2
        thresh7=320**2

c
c       check if if the user-specified z is in one of the 
c       intermediate regimes 
c
        d=z*dconjg(z)
        if( (d .le. thresh0) .or. (d .gt. thresh7) ) goto 3400
c
c        the user-specified z is in one of the intermediate regimes.
c        act accordingly
c
c
        if(d .gt. thresh1) goto 1900
c
c       z is in the first intermediate regime: its absolute value is 
c       between 1 and 5. act accordingly
c
c       . . . evaluate the expansion
c
        nu=3*(z/2)**toth
c 
        cd=done/nu
c
        m=63
        call abram1p(c1p0,m,cd,j1)
        j1=dc*sqrt(nu/3)*j1*(nu**26)
        if (ifexpon .eq. 1) j1=j1*exp(-nu)
        
        return
 1900 continue
c
        if(d .gt. thresh2) goto 2000
c
c       z is in the first intermediate regime: its absolute value is 
c       between 5 and 10. act accordingly
c
c       . . . evaluate the expansion
c
        nu=3*(z/2)**toth
c 
        cd=done/nu
c
        m=48
        call abram1p(c1p1,m,cd,j1)
        j1=dc*sqrt(nu/3)*j1*nu
        if (ifexpon .eq. 1) j1=j1*exp(-nu)

        return
 2000 continue
c
        if(d .gt. thresh3) goto 3000
c       z is in the second intermediate regime: its absolute value is
c       between 10 and 20. act accordingly.
c
        nu=3*(z/2)**toth
c 
        cd=done/nu
c
        m=38
        call abram1p(c1p2,m,cd,j1)
        j1=dc*sqrt(nu/3)*j1
        if (ifexpon .eq. 1) j1=j1*exp(-nu)

        return

        return
 3000 continue
c
        if(d .gt. thresh4) goto 3100
c       z is in the third intermediate regime: its absolute value is
c       between 20 and 40. act accordingly.
c
        nu=3*(z/2)**toth
c 
        cd=done/nu
c
        m=34
        call abram1p(c1p3,m,cd,j1)
        j1=dc*sqrt(nu/3)*j1
        if (ifexpon .eq. 1) j1=j1*exp(-nu)

        return
 3100 continue
c
        if(d .gt. thresh5) goto 3200
c       z is in the fourth intermediate regime: its absolute value is
c       between 40 and 80. act accordingly.
c
        nu=3*(z/2)**toth
c 
        cd=done/nu
c
        m=32
        call abram1p(c1p4,m,cd,j1)
        j1=dc*sqrt(nu/3)*j1
        if (ifexpon .eq. 1) j1=j1*exp(-nu)

        return
 3200 continue
        
        if(d .gt. thresh6) goto 3300
c       z is in the fourth intermediate regime: its absolute value is
c       between 80 and 160. act accordingly.
c
        nu=3*(z/2)**toth
c 
        cd=done/nu
c
        m=30
        call abram1p(c1p5,m,cd,j1)
        j1=dc*sqrt(nu/3)*j1
        if (ifexpon .eq. 1) j1=j1*exp(-nu)

        return
 3300 continue
        if(d .gt. thresh7) goto 3400
c       z is in the fourth intermediate regime: its absolute value is
c       between 160 and 320. act accordingly.
c
        nu=3*(z/2)**toth
c 
        cd=done/nu
c
        m=30
        call abram1p(c1p6,m,cd,j1)
        j1=dc*sqrt(nu/3)*j1
        if (ifexpon .eq. 1) j1=j1*exp(-nu)

        return
 3400 continue
c
c        z is either in the local regime or the asymptotic one.
c        if it is in the local regime - act accordingly.
c
        if(d .ge. 102400.d0) goto 4000
        call abram1series(z,j1,ifexpon)
        return
c
c        z is in the asymptotic regime. act accordingly.
c
 4000 continue
        call abram1asym(z,j1,ifexpon)
        return
        end
c
c
c
c
c
