c
c
c
c
c
ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
c
c
c        this is the end of the debugging code and the beginning of the
c        Abramowitz function code proper.
c
c
ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
c
c
        subroutine abram2(z,j2,ifexpon)
        implicit real *8 (a-h,o-z)
        complex *16 z,j2,j2u,com,zu,ima
        real *8 rea(2)
        equivalence (rea(1),com)
        data ima/(0.0d0,1.0d0)/,
     $     pi/3.141592653589793238462643383279502884197d0/
c
c        this subroutine evaluates the Abramowitz function J_2
c        for a user-specified complex number z with Re(z)>=0.
c        
c        The code is reasonably accurate (32-digit relative accuracy
c        when ifexpon=0) 
c        and reasonably fast (O(1) cost for any z).
c
c        When ifexpon=1, that is, the Abramowitz function is evaluated
c        honestly. The subroutine will lose accuracy gradually
c        simply due to the ill-conditioning of evaluating the 
c        exponential factor exp(-nu) with nu=3(z/2)**(2/3).
c        The condition number of evaluating exp(-nu) is abs(nu). 
c        Thus, the subroutine will lose an extra log_{10}abs(nu) 
c        digits if the function is evaluated honestly.
c        
c
c
c     
c                      input parameters:
c
c  z - the complex number for which the Abramowitz function
c        J_2 is to be evaluated
c
c
c  ifexpon - the integer parameter telling the subroutine whether
c        to calculate the actual values of the Abramowitz function,
c        or the values of the Abramowitz function scaled by e^{nu}.
c        Permitted values: 0 and 1. 
c    ifexpon = 1 will cause the subroutine to evaluate the Abramowitz 
c        function honestly
c    ifexpon = 0 will cause the subroutine to scale the Abramowitz 
c        function by e^{nu}, where nu=3(z/2)^(2/3).
c        
c                      output parameters:
c
c  j2 - the said Abramowitz function
c        
c       
c        . . . if z in the upper half-plane - act accordingly
c
        com=z 
        if(rea(2) .lt. 0) goto 1400
        call abram2ur(z,ier,j2,ifexpon)
        return
 1400 continue
c
c       z is in the right lower quadrant. compute 
c       j2 at the points zu obtained from z by reflection
c       in the x axis.
c
        zu=dconjg(z)
c
        call abram2ur(zu,ier,j2u,ifexpon)
        j2=dconjg(j2u)

        return
        end
c
c
c
c
c
        subroutine abram2p(p,m,z,f)
        implicit real *8 (a-h,o-z)
        complex *16 p(1),z,f
c
c       evaluate a polynomial at a point
c
        f=p(m)
        do 1200 i=m-1,1,-1
        f=f*z+p(i)
 1200 continue
        return
        end
c
c
c
c
c
        subroutine abram2pr(p,m,z,f)
        implicit real *8 (a-h,o-z)
        real *8 p(1),z,f
c
c       evaluate a polynomial at a point
c
        f=p(m)
        do 1200 i=m-1,1,-1
        f=f*z+p(i)
 1200 continue
        return
        end
c
c
c
c
c
        subroutine abram2pc(p,m,z,f)
        implicit real *8 (a-h,o-z)
        real *8 p(1)
        complex *16 z,f
c
c       evaluate a polynomial at a point
c
        f=p(m)
        do 1200 i=m-1,1,-1
        f=f*z+p(i)
 1200 continue
        return
        end
c
c
c
c
c
        subroutine abram2asym(z,j2,ifexpon)
c
c        evaluate the asymptotic expansion for J_2 at
c        the user-supplied point z.
c
        implicit real *8 (a-h,o-z)
        dimension c(51)
        complex *16 z,j2,nu,pp,cd
        data ima/(0.0d0,1.0d0)/,
     $     dc/1.0233267079464884884795516248892648607073764377510d0/,
     1     toth/0.66666666666666666666666666666666666666666666666667d0/
c
        data c/
     1     +1.0000000000000000000000000000000000000000000000000D0,
     2     +1.4166666666666666666666666666666666666666666666667D0,
     3     -1.2152777777777777777777777777777777777777777777778D-1,
     4     +1.8566743827160493827160493827160493827160493827160D-1,
     5     -3.5199451838991769547325102880658436213991769547325D-1,
     6     +7.4505506392532578875171467764060356652949245541838D-1,
     7     -1.5693903747009733177107148300563938424020728547478D0,
     8     +2.4641895793241704254623278971701468272112990905858D0,
     9     +3.3765931072746918614052921090958356619079069924978D0,
     *     -6.9604561729484686210500760574590280639494004665303D1,
     1     +5.3956594819859491514246686656828471760950154600626D2,
     2     -3.3224022418994497487176624011744842470841158842273D3,
     3     +1.7033328329159777112976170573211527091802244453571D4,
     4     -6.0489750622577286670666591009445979661808400728065D4,
     5     -8.4094252422393569480877091780707324586162676124851D4,
     6     +4.7624684859435969638522363988894824887956699940276D6,
     7     -6.5236060492411640407337393666532058424518680632467D7,
     8     +6.6345965427244272724061424089148178382025140808591D8,
     9     -5.3961244840730159722259104894720580184152118840010D9,
     *     +2.9916346948733031846678917542122277915570169474823D10,
     1     +4.1829228052619580505549494228705186056837316260227D10,
     2     -4.5839905262650183687141353756604321782395059257333D12,
     3     +9.0167507999909832662247509807119794212237744663985D13,
     4     -1.2782423918936455170735326346078976158119085660508D15,
     5     +1.4235154288839102590791011742014725922258617332698D16,
     6     -1.0733624565391904094329367300369923719286478354685D17,
     7     -1.5053858547833294368117373666984494621517238789167D17,
     8     +2.7019176157095582426109075871313193960810939763894D19,
     9     -6.9312585173432089582185096771004715072848797065067D20,
     *     +1.2601012711598539363878303662818904384869150042858D22,
     1     -1.7815820079551951303751209667027333002863650757315D23,
     2     +1.6992475443360827335584544244176391496286216996922D24,
     3     +2.3877314410529786196242148192664826128871318824259D24,
     4     -6.3589801425099493362298606067202439133625052987110D26,
     5     +2.0120881860340403152479792315535178076681037628474D28,
     6     -4.4632968563710345503004400825851991278781523038986D29,
     7     +7.6499389872165304003565234352845051083082620916096D30,
     8     -8.8251591220794650649590291720969659268433561761993D31,
     9     -1.2416965975488320605508356543433624258121376838279D32,
     *     +4.5954584070198290638987321594974180563988985000438D34,
     1     -1.7294303311076263806974008965067518975288210631146D36,
     2     +4.5283653218245446547363006050046140054057193620856D37,
     3     -9.1203782104724494797062540739218751873527856637069D38,
     4     +1.2344506127618071322653240638391835765580693379199D40,
     5     +1.7385045190429625904602686004026156705271548204686D40,
     6     -8.5327923875107385941845391000244138003415273232039D42,
     7     +3.7226252079804441518376075822980480815819869985662D44,
     8     -1.1236908168316270942112092919581324883032930101380D46,
     9     +2.6003577116207454594094242255779716253193025965578D47,
     *     -4.0394470049640887952995722128778489794454293797018D48,
     1     -5.6929099468560966450376493773881360453519401243403D48/


c
        m=32
        nu=3*((z/2)**toth)

        pp=c(m+1)
        cd=1/nu
c
        do 1800 i=m,1,-1
        pp=pp*cd+c(i)
 1800 continue
c 
        j2=dc*(nu/3)*pp
        if (ifexpon .eq. 1) j2=j2*exp(-nu)      
c     
        return
        end
c
c
c
c
c
        subroutine abram2series(z,j2,ifexpon)
        implicit real *8 (a-h,o-z)
        dimension a(24),b(50)
        complex *16 z,j2,lnz,z2,c1,c2,nu
c
c
c        this subroutine evaluates the Abramowitz function J_2
c        for a user-specified complex number z in the local regime,
c        i. e. for cdabs(z) < 1, using the series expansion 
c
c                      input parameters:
c
c  z - the complex number for which the Abramowitz function
c        J_2 is to be evaluated
c
c                      output parameters:
c
c  j2 - the said Abramowitz function
c        
        data a/
     4     +3.3333333333333333333333333333333333333333333333333D-1,
     6     -1.6666666666666666666666666666666666666666666666667D-2,
     8     +1.9841269841269841269841269841269841269841269841270D-4,
     *     -9.1857730746619635508524397413286302175191064079953D-7,
     2     +2.0876756987868098979210090321201432312543423654535D-9,
     4     -2.6765073061369357665653961950258246554542850839147D-12,
     6     +2.1242121477277267988614255516077973455986389554879D-15,
     8     -1.1156576406133018901583117392898095302513860060335D-18,
     *     +4.0776960548731794230932446611469646573515570395963D-22,
     2     -1.0787555700722696886490065241129536130559674707927D-25,
     4     +2.1319280040953946415988271227528727530750345272582D-29,
     6     -3.2301939455990827903012532162922314440530826170579D-33,
     8     +3.8345132307681419637954098009167039934153402386728D-37,
     *     -3.6325437957257881430422601372837286788701593772952D-41,
     2     +2.7899721933377789117068050209552447610369887690439D-45,
     4     -1.7613460816526382018351041798959878541900181622752D-49,
     6     +9.2507672355705787911507572473528773854517760623697D-54,
     8     -4.0853061453676818544209314817845245475409715873387D-58,
     *     +1.5314537956843911585023734749529631682189876995572D-62,
     2     -4.9148067897445159130371420890659921958247358779113D-67,
     4     +1.3606884799957131542184778762641174407045226683032D-71,
     6     -3.2724590668487569846524239448391472840416610589303D-76,
     8     +6.8801174561617126075444116239995527795005909068420D-81,
     *     -1.2718347855962941081677779547470335661602689490613D-85/


        data b/
     1     +8.8622692545275801364908374167057259139877472806119D-1,
     2     -1.0000000000000000000000000000000000000000000000000D0,
     3     +8.8622692545275801364908374167057259139877472806119D-1,
     4     -3.2250327866034468080785506606990989559003144314115D-1,
     5     -1.4770448757545966894151395694509543189979578801020D-1,
     6     +3.1958497266350567373726086636828828112834905490391D-2,
     7     +3.2823219461213259764780879321132318199954619557822D-3,
     8     -4.9147492966365943774466051740744825606738455137842D-4,
     9     -2.3445156758009471260557770943665941571396156827016D-5,
     *     +2.6453294232093450029494293664676265692583369311481D-6,
     1     +7.4429069073045940509707209344971243083797323260367D-8,
     2     -6.6716280575925263153646582316643783600061148180593D-9,
     3     -1.2530146308593592678401887095113003886161165532048D-10,
     4     +9.2499474881260567640736328964802830321324803719154D-12,
     5     +1.2517628679913678999402484610502501384776389142905D-13,
     6     -7.8115894264619782071079131947451257869480163813464D-15,
     7     -8.0241209486626147432067209041682701184464032967343D-17,
     8     +4.3177708931549684878130323545506753595327074819122D-18,
     9     +3.4963489972386120885432335094415120341814393449823D-20,
     *     -1.6477336618850679703477656725973094331253747060166D-21,
     1     -1.0824609898571554453694221391459789579509100139264D-23,
     2     +4.5243217179689216542871511913847868976754370967605D-25,
     3     +2.4663043742473352594427480955706971017336751285632D-27,
     4     -9.2375420092032171889161042255223593917324348300923D-29,
     5     -4.2551835304474383358225467487417134260415374888944D-31,
     6     +1.4406901941271182174276332379347390318012861305551D-32,
     7     +5.6925532179898840613010658846042988977144314232701D-35,
     8     -1.7551481952929721968308332534066796061447003071116D-36,
     9     -6.0238658391427344564032443223325914261528374849420D-39,
     *     +1.7021726720632313251530200617481280542737220871250D-40,
     1     +5.1288768319648654375506550211431174339317475393290D-43,
     2     -1.3356162867076471804903477879988692263224270115120D-44,
     3     -3.5656818909655627346709225675355377043463205918583D-47,
     4     +8.5990487267353935142924836099918303268365087404737D-49,
     5     +2.0503029676071316972404821847711676754334544257710D-51,
     6     -4.5988546544473412016565834956010271605122554704692D-53,
     7     -9.8619671361574396211663404750897916086265244144829D-56,
     8     +2.0653424494963358481807059967137687880382714178766D-57,
     9     +4.0081150726102172815144647328143839092162261387860D-60,
     *     -7.8644342170135809271331964332209413503759532397892D-62,
     1     -1.3888132614727017607465227764429604675038898609792D-64,
     2     +2.5610957988394268477284154733960231406532280998553D-66,
     3     +4.1359577756118459773862318009558368846716395990923D-69,
     4     -7.1885784052428440230695527478271819425104286403966D-71,
     5     -1.0663532655112272411143793639343672677439384311587D-73,
     6     +1.7513559427522967737519878663805034062917700168522D-75,
     7     +2.3960302561762211911344329040205982872574731629227D-78,
     8     -3.7273359474344345493982407735445925654555301585608D-80,
     9     -4.7203117733968108572388355083148114406175594226215D-83,
     *     +6.9703256406752815174199884805952824590627967347962D-85/

c
c        evaluate j2
c
        m=29
        c1=b(m)
        do k=m-1,1,-1
           c1=c1*z+b(k)
        enddo

        m2=15
        c2=a(m2)
        z2=z**2
        do k=m2-1,1,-1
           c2=c2*z2+a(k)
        enddo

        j2=(c1+c2*log(z)*z2*z)/2
        if (ifexpon .eq. 1) return

        nu=3*(z/2)**(2.0d0/3)
        j2=j2*exp(nu)        
        
c
        return
        end
c
c
c
c
c
        subroutine abram2ur(z,ier,j2,ifexpon)
        implicit real *8 (a-h,o-z)
        complex *16 z,com,ima,cd,j2,nu
        dimension rea(2)
        equivalence (rea(1),com)
        real *8 c2p0(126)
        real *8 c2p1(96)
        real *8 c2p2(76)
        real *8 c2p3(68)
        real *8 c2p4(64)
        real *8 c2p5(64)
        real *8 c2p6(60)
        data ima/(0.0d0,1.0d0)/,
     $     dc/1.0233267079464884884795516248892648607073764377510d0/,
     1     toth/0.66666666666666666666666666666666666666666666666667d0/
        
c
c        this subroutine evaluates the Abramowitz function J_2
c        for a user-specified complex number z in the upper right quadrant.
c        it is reasonably accurate (32-digit relative accuracy) 
c        and reasonably fast.
c        
c
c                      input parameters:
c
c  z - the complex number for which the Abramowitz function
c        J_2 is to be evaluated
c
c                      output parameters:
c
c  ier - error return code. 
c         ier=0 means successful conclusion
c         ier=4 means that z is not in the upper right quadrant
c  j2 - the said Abramowitz function
c        

c  rsmall=0.99902E+00, rlarge=0.50010E+01, iback= 27, m=  63 relerr=0.1974E-33
        data c2p0/
     1     -.3795513238084266277304896529795934D-34,
     2     0.3082587255582007070401915407745719D-34,
     3     0.9714767545269353411146546664524615D-32,
     4     -.1653788700028398953274330598588361D-32,
     5     -.9212745008346570975023639617665648D-30,
     6     -.3305042722111782995802088752641554D-30,
     7     0.4180646630048408222107670176020818D-28,
     8     0.4827103103167397474975777819020296D-28,
     9     -.6165382099575249355234872756610247D-27,
     *     -.3015716574940855800217653701908652D-26,
     1     -.3564547497545508286143906213832701D-25,
     2     0.1113232147785051313884326715820709D-24,
     3     0.2664782244181789825477360589531818D-23,
     4     -.2482308031704304587234955388099182D-23,
     5     -.9298672427770928424137040904538048D-22,
     6     0.2272126976148116412623578988862260D-22,
     7     0.2087751329927023937789229286927751D-20,
     8     0.5776869611833542887508416525076143D-21,
     9     -.3050969353493632129949915756752753D-19,
     *     -.3010833048489508507301900165845534D-19,
     1     0.2103859570663008864392127789171109D-18,
     2     0.7206508877367836414188603751277989D-18,
     3     0.2598857862802592358072089630784690D-17,
     4     -.1146120182954113674736136019015273D-16,
     5     -.1104123456222497943519977164597293D-15,
     6     0.1236378006509402530582881668371907D-15,
     7     0.2001511450872278715279680817703482D-14,
     8     -.7014043540767676084297517589191104D-15,
     9     -.2441331747897898938399509264287291D-13,
     *     -.4099561540793609552848307308124064D-14,
     1     0.2079145786086377675290963051431542D-12,
     2     0.1641371376085964995651905274510779D-12,
     3     -.1021978274215656051824328262887919D-11,
     4     -.2401200686427649556934789138873794D-11,
     5     -.2270137923166713846148612813838475D-11,
     6     0.2364865459670818438875565218167912D-10,
     7     0.1117937861536322084655752939179483D-09,
     8     -.1664641666894612747071035830994316D-09,
     9     -.1391112121115357009045413984726230D-08,
     *     0.7358229508950274692748696885045659D-09,
     1     0.1151489090646418271885292539378566D-07,
     2     0.3405614180781356927776457235552974D-10,
     3     -.6953245822266769383811640183174324D-07,
     4     -.3694414100421306534164857183824346D-07,
     5     0.2855014637763779156256290593630494D-06,
     6     0.4156125756449299813687221545998622D-06,
     7     -.3851587538783705192969625829848271D-06,
     8     -.3005314046756597584768240972855569D-05,
     9     -.5698528168053671330650530238456218D-05,
     *     0.1613614279727705098499630647399552D-04,
     1     0.6507409028628148236054097464810181D-04,
     2     -.6357404187989059169806292686836323D-04,
     3     0.9995686127742923930292204319869264D+00,
     4     0.1467823390618474454436337374650707D-03,
     5     0.1418806641761421489615735429756740D+01,
     6     0.2207614997832226684114918208569550D-03,
     7     -.1298577112088198740252258708819376D+00,
     8     -.4706786140800726817555178959920313D-02,
     9     0.2104968219663365880099151916820477D+00,
     *     0.3134512767464645285408841420313478D-01,
     1     -.4005887656117806791960905956775942D+00,
     2     -.1484095489881848633833978673404350D+00,
     3     0.7499008237982898383049853644070185D+00,
     4     0.5627397376944841435060339499022789D+00,
     5     -.1155998085012727731082853779963140D+01,
     6     -.1771805855954698241951860169411101D+01,
     7     0.8850430097439217765382351556916817D+00,
     8     0.4665802896854747747290234264858704D+01,
     9     0.2394432576724882823633994403848612D+01,
     *     -.1013058182764604517797430644608939D+02,
     1     -.1371496166884258961503596595528182D+02,
     2     0.1723821028980269833567584795160427D+02,
     3     0.4033239589921695422974787093673652D+02,
     4     -.1918799823910347247352229366210265D+02,
     5     -.8627917781508909684885276030006995D+02,
     6     -.1853103891531567176713508709773716D+01,
     7     0.1392343466019879611311661651211364D+03,
     8     0.7519604453689829580826176455556728D+02,
     9     -.1539587145450790389701142640322697D+03,
     *     -.2271735092020990342056371489289391D+03,
     1     0.4957647893154318467571459161756239D+02,
     2     0.4460404549025931282518618623832700D+03,
     3     0.2548167739597403125979484418613745D+03,
     4     -.6414420762727179296467702315296277D+03,
     5     -.7610855687315147420730741944574543D+03,
     6     0.6419189280119878949869991284516239D+03,
     7     0.1315241187394522695155989864480397D+04,
     8     -.2749544808926600249503039823679791D+03,
     9     -.1620943740963982116040780118597326D+04,
     *     -.4848418369412059954134762944336672D+03,
     1     0.1396219787225981718377087175097386D+04,
     2     0.1406780502675757312584601302095297D+04,
     3     -.5984258593707467926363843962519448D+03,
     4     -.2068780008747150677871474553769251D+04,
     5     -.4715671065252693281428810772244683D+03,
     6     0.2110979698426545181456875309581090D+04,
     7     0.1322538066441037643465156035295499D+04,
     8     -.1501023118700753699996618350156310D+04,
     9     -.1596554036485851025864692620861573D+04,
     *     0.5738468603035966147987359515902253D+03,
     1     0.1296105957413179799668885898613346D+04,
     2     0.2082303643666028343242671135270580D+03,
     3     -.7254560680502687334369108614265263D+03,
     4     -.5681799536359650394333698882899397D+03,
     5     0.2272850653204091540787143791922777D+03,
     6     0.5367207597486719524370522122547970D+03,
     7     0.3481895744574599644490523292796129D+02,
     8     -.3277046211697100001628252381598152D+03,
     9     -.9486510822074890102009227120019899D+02,
     *     0.1349125298361987551511357909748307D+03,
     1     0.6497649410979356423608142716452746D+02,
     2     -.3142336012612830148280874335790042D+02,
     3     -.2715073189681813184184053247929512D+02,
     4     -.1563433853610388935259133993071291D+01,
     5     0.7297349038232860591417814814231880D+01,
     6     0.4635499213942419983021231163056237D+01,
     7     -.1073199306734686664616427205662300D+01,
     8     -.1982947757332383004177291163458257D+01,
     9     -.6068186189469438115086530297711938D-02,
     *     0.4632517402619820653900519800935851D+00,
     1     0.3510482499870018003006270394006412D-01,
     2     -.6094189721710710354403403640065908D-01,
     3     -.6021214689994132887310129668144544D-02,
     4     0.3595771725635160732356751057619378D-02,
     5     0.3444998758231334143084857207664530D-03,
     6     -.9720811649267848958147479664259455D-05/


c  rsmall=0.49990E+01, rlarge=0.10001E+02, iback=  1, m=  48 relerr=0.1988E-33
        data c2p1/
     1     0.9999999999999999881114227980991952D+00,
     2     0.1639976454921962243056156077564784D-16,
     3     0.1416666666666672078453905457365593D+01,
     4     -.2448234227423006331348600795291191D-14,
     5     -.1215277777786310640408870201421151D+00,
     6     -.7931937269180037535717505158260416D-13,
     7     0.1856674383381092282580131983445056D+00,
     8     0.4636587982402914858612055479048310D-10,
     9     -.3519945208368389921762392590044997D+00,
     *     -.5098412965261697589234425564330422D-08,
     1     0.7450550437679881072573564681331728D+00,
     2     0.3094585325485050473416880034330290D-06,
     3     -.1569382803002392941910775104800645D+01,
     4     -.1167908539281314513107356889269845D-04,
     5     0.2463725387439354388592577900484251D+01,
     6     0.2465933206762454646285070182873706D-03,
     7     0.3393629716493067630597141893480573D+01,
     8     0.2646167011553926042604312958165821D-03,
     9     -.7002336773217366760418163016676438D+02,
     *     -.2371497389284881542399316028061069D+00,
     1     0.5459405419189374800421315648061803D+03,
     2     0.1014825779087142852041948251887159D+02,
     3     -.3341546947683808091407781837471097D+04,
     4     -.2647482432211703737406257485145429D+03,
     5     0.1493791557617340863540306388223204D+05,
     6     0.4831405634274560344183487466766840D+04,
     7     0.1213546344885355107954728247108187D+05,
     8     -.5980480350567375267919072614292690D+05,
     9     -.1564166109286907632258037319071174D+07,
     *     0.3413208573113841400825256699757676D+06,
     1     0.2641682451941457601228167967021415D+08,
     2     0.4914408178351912432991459713586323D+07,
     3     -.2977128738669049011590436985716277D+09,
     4     -.1798096846199026003062175018511878D+09,
     5     0.2329258371309936195495138582449655D+10,
     6     0.3091397058145161560602095848883247D+10,
     7     -.8963606224073419286576446588917352D+10,
     8     -.3742954042749886506000829805125089D+11,
     9     -.6982249257652888374453948094244310D+11,
     *     0.3408595752821058905627881359112591D+12,
     1     0.1773204377658864737405055283450774D+13,
     2     -.2277284054144329268875266084846515D+13,
     3     -.2006631511503161514240034699669777D+14,
     4     0.9229185050914568720017172757682346D+13,
     5     0.1561275334931342821554401300993737D+15,
     6     0.9737055076118597466118992328910610D+13,
     7     -.8659890774070253932640139490418264D+15,
     8     -.5527221180864196825471974689891201D+15,
     9     0.2930122907124980040445205840394707D+16,
     *     0.5534856242114502149695782929592856D+16,
     1     0.1311249156643149666119571649892575D+16,
     2     -.3542287864830787011716612154242200D+17,
     3     -.1000754655925749529691235183379901D+18,
     4     0.1570809225375717868982200000743164D+18,
     5     0.8100711299357951687746722600090126D+18,
     6     -.4098181731559691544593201904233623D+18,
     7     -.4090100236986393275680810944397035D+19,
     8     -.2890855048351641488223746078669677D+18,
     9     0.1402201117380546067329525469649750D+20,
     *     0.9846406040218830529093465390746546D+19,
     1     -.2665877048295027482532668041407473D+20,
     2     -.6049771468726163446309158451198576D+20,
     3     -.3038433014259259990316494879126616D+20,
     4     0.2330107799799495720710656492314143D+21,
     5     0.4794397672326063168633404249837392D+21,
     6     -.5989484471272321483037915967388453D+21,
     7     -.2153976578961066728052336389308349D+22,
     8     0.7867983913460727277737458813686354D+21,
     9     0.6131734504207582243141243381001459D+22,
     *     0.1212186853276047073695968309290292D+22,
     1     -.1141785689457902637268212989329143D+23,
     2     -.1042861220222676447916994466398050D+23,
     3     0.9752779506222282409226444569974001D+22,
     4     0.3313021616147205906686050777380340D+23,
     5     0.1760434182033676676680006918208506D+23,
     6     -.6689864793701149214032191275073643D+23,
     7     -.8845528819284457376467082824802223D+23,
     8     0.8589580964964300345464796484622621D+23,
     9     0.1886347608235646398066476488943113D+24,
     *     -.4394056121400743507804691203389430D+23,
     1     -.2521550273195426878276692170137923D+24,
     2     -.8134883335458341693304400399766043D+23,
     3     0.2046581283144482351030704311093393D+24,
     4     0.2339432013826416234700672822155835D+24,
     5     -.5476402590455692363197355540536356D+23,
     6     -.3015361880078204872950406434952388D+24,
     7     -.8666981639253064629264089041410008D+23,
     8     0.2313062122229624604001179426430544D+24,
     9     0.1220255185993799556056160343633208D+24,
     *     -.9767305286512195601785678142638929D+23,
     1     -.7212796112800805187611483664837095D+23,
     2     0.1005843895135303768204490306096603D+23,
     3     0.2048956184652843009720437378690751D+23,
     4     0.8592433479846522183692225025632733D+22,
     5     -.1985718495210650497568954989942004D+22,
     6     -.2673492346020418621012398944112733D+22/


c  rsmall=0.99990E+01, rlarge=0.20001E+02, iback=  1, m=  38 relerr=0.1104E-32
        data c2p2/
     1     0.9999999999999999999044031258264871D+00,
     2     0.2856403875194541602650987815601913D-18,
     3     0.1416666666666666750210557474875305D+01,
     4     -.7666747835928080612612066828463034D-16,
     5     -.1215277777777980848585758793230782D+00,
     6     0.4946516369168748810042252166733678D-14,
     7     0.1856674382740320902687540107955762D+00,
     8     0.6524956631961487993329760086533476D-12,
     9     -.3519945185502865667715009972124288D+00,
     *     -.1529929882970133104451315760364652D-09,
     1     0.7450550686201033234450167874808427D+00,
     2     0.1453810282337580091682139100738370D-07,
     3     -.1569390220390394583061478252256784D+01,
     4     -.8426213941962375403015554151018003D-06,
     5     0.2464164612494119429813522511499080D+01,
     6     0.3144860279096074143664243788527282D-04,
     7     0.3378062104869442135197438635741717D+01,
     8     -.6456887262176056793964994535685839D-03,
     9     -.6965991448392506400434307490111814D+02,
     *     -.3690697912068804224196501021390836D-02,
     1     0.5410039060223187400914959993642062D+03,
     2     0.8646961421662835722921700952076150D+00,
     3     -.3346251871895869648014277039439290D+04,
     4     -.3790799014367142810888803601889119D+02,
     5     0.1714162771677715572366909646436499D+05,
     6     0.1056456714896806006206940134872992D+04,
     7     -.5284106969905068226596796672899626D+05,
     8     -.2114292824243414708027549341392638D+05,
     9     -.3852492631202469703446193655484338D+06,
     *     0.3019918145971743980100697138541813D+06,
     1     0.1154604328045143623233131251456459D+08,
     2     -.2593121492001703249454279988665609D+07,
     3     -.1761885549570543679445341233840780D+09,
     4     -.4163269485925580131943054888642084D+07,
     5     0.2054635226140878572957175638286320D+10,
     6     0.6143769045793199340990934024020764D+09,
     7     -.1881867466840457701922071073809772D+11,
     8     -.1281448972015836718605953866026352D+11,
     9     0.1267562871488664319530015670534643D+12,
     *     0.1743597146058870342153655837862512D+12,
     1     -.4605538183005747373874599592389272D+12,
     2     -.1777901957870653033114911370737732D+13,
     3     -.2062731163569151403735889760711640D+13,
     4     0.1398086556488337694291203501903225D+14,
     5     0.5274909101390338719879943064580572D+14,
     6     -.8296022068314619566792112393276989D+14,
     7     -.5206058476623654256123580715938466D+15,
     8     0.3326280981904517242729806599714662D+15,
     9     0.3474850289351800205016424907900186D+16,
     *     -.4179187747255249814395711053656063D+15,
     1     -.1679851827862350515869932569269001D+17,
     2     -.5936998497968366443977039704184036D+16,
     3     0.5607996629945126625886739491476338D+17,
     4     0.5865123314345036552958804182873523D+17,
     5     -.9331335169330122664588132694883164D+17,
     6     -.3152961775173216996768096348732557D+18,
     7     -.2262971272579007544122116897224223D+18,
     8     0.1155015022429140857399926683500134D+19,
     9     0.2318281710404670891718532298044694D+19,
     *     -.2868606977009734710958375693074742D+19,
     1     -.9211161345860375674473721391390947D+19,
     2     0.3901577654274719001090213340471211D+19,
     3     0.2303559543827098630104388214602978D+20,
     4     0.2157126958610622437472014528177983D+19,
     5     -.3716344260682064655883192209020636D+20,
     6     -.2490815411397948664463269584994993D+20,
     7     0.3253522430066255961077919266609065D+20,
     8     0.6240333630690688097226027652094574D+20,
     9     0.1852489400847693320305329514208123D+19,
     *     -.8650056289351560197065005518498629D+20,
     1     -.3911864788661657421897282495887374D+20,
     2     0.6747435930244385359161396649314706D+20,
     3     0.3933911246522770593220326742034306D+20,
     4     -.2356390820156883068124469313099882D+20,
     5     -.1319063901411266624440949982773358D+20,
     6     0.4281813938752996374936697214436269D+18/

        
c  rsmall=0.19999E+02, rlarge=0.40001E+02, iback=  1, m=  34 relerr=0.5180E-33
        data c2p3/
     1     0.1000000000000000000000614018250938D+01,
     2     0.1833643878700471783514532944833119D-21,
     3     0.1416666666666666666429662456360459D+01,
     4     -.2424549784876981311133255846637505D-18,
     5     -.1215277777777777545105271540359356D+00,
     6     0.8445409153329863972587739248010411D-16,
     7     0.1856674382716083633627703527453477D+00,
     8     -.1431832777433086901439228676404633D-13,
     9     -.3519945183911328222738764254809384D+00,
     *     0.1339825258842894653576700556705643D-11,
     1     0.7450550640888399178682918157669376D+00,
     2     -.5681397359221100239806994445833547D-10,
     3     -.1569390387950265224903085695506730D+01,
     4     -.2178333237096899066355867059171262D-08,
     5     0.2464190265766909680028550115362982D+01,
     6     0.5300326245719409161721479357930387D-06,
     7     0.3376573630189071711292864827088941D+01,
     8     -.4338533750547703042764763702606982D-04,
     9     -.6960470875599154246085107227568033D+02,
     *     0.2241312741933542033042295483144847D-02,
     1     0.5396141116384069852641524625727096D+03,
     2     -.7883338449833840599395018936856943D-01,
     3     -.3325256043649871295356868612526043D+04,
     4     0.1729503000549626563660014706224064D+01,
     5     0.1713959561860034149047456841665333D+05,
     6     -.7859521305218645266484993934337755D+01,
     7     -.6328673766776798812705145535247141D+05,
     8     -.1147513982416111398926804934633097D+04,
     9     -.3319916235499620092850475365404325D+05,
     *     0.5710858988120203619688741604035263D+05,
     1     0.4273777430554838662578354376561008D+07,
     2     -.1660261103080141253131737666999545D+07,
     3     -.7014895819491280666372728885121618D+08,
     4     0.3471735403149805301404842057706549D+08,
     5     0.9953265176001815128657133962220972D+09,
     6     -.5429627164298268166341916185131672D+09,
     7     -.1369742469460309576437182307190211D+11,
     8     0.6159361441963620137337566231467783D+10,
     9     0.1737672284147745568068668492768140D+12,
     *     -.4236265025523800115142610807692614D+11,
     1     -.1893865257561265566062925890612662D+13,
     2     -.4367371127240705903862393293784477D+11,
     3     0.1675982955070812012154499048829265D+14,
     4     0.5953052285518217332564087283253681D+13,
     5     -.1129844161841167380363644810544290D+15,
     6     -.9518805333502353664303536420605731D+14,
     7     0.5014560096059444965318297559349918D+15,
     8     0.9591889855778387911422910863806615D+15,
     9     -.4853693801204833418673809483979547D+15,
     *     -.6941163852360739042595252364265106D+16,
     1     -.1371920797041466152243789539942264D+17,
     2     0.3646067762077308715331259608632145D+17,
     3     0.1353207728373104005853307838719182D+18,
     4     -.1304768324553565330551181222490620D+18,
     5     -.7335477944638187300581213265852425D+18,
     6     0.2367817201837101282048768000874871D+18,
     7     0.2604502189679870355733781733139046D+19,
     8     0.3983468892912732797583640580886578D+18,
     9     -.5934008456082094426213409545935285D+19,
     *     -.4264672791436156553170361210669156D+19,
     1     0.7159693439042863358251319122236867D+19,
     2     0.1408842854072294004984984123022973D+20,
     3     0.3076052131174761725495070611905515D+18,
     4     -.2500513992366866671042357384327087D+20,
     5     -.1232654506408825963833622863735185D+20,
     6     0.2261875984735356844610043945264541D+20,
     7     0.1083348301952260210271135338179621D+20,
     8     -.7123251577077340532810925088522395D+19/


c  rsmall=0.39999E+02, rlarge=0.80001E+02, iback=  1, m=  32 relerr=0.5213E-33
        data c2p4/
     1     0.1000000000000000000000007521686183D+01,
     2     -.1343541072911316681961469206369062D-24,
     3     0.1416666666666666666661722192504323D+01,
     4     -.2795744296936261944701199522743896D-20,
     5     -.1215277777777777767322910914092178D+00,
     6     0.1807329104196075991367214094308886D-17,
     7     0.1856674382716049415906708920840605D+00,
     8     -.4975291775977315374255439546378557D-15,
     9     -.3519945183899618832528431012192876D+00,
     *     0.7418384568346889259252086123726803D-13,
     1     0.7450550639355074648401254089779784D+00,
     2     -.5609129319905758241496114870632663D-11,
     3     -.1569390375963160515711362642542333D+01,
     4     -.3289109466847987698033732516773976D-10,
     5     0.2464189675877839637255774486671615D+01,
     6     0.5989490609967742898966186952010213D-07,
     7     0.3376589069207432248408809830355958D+01,
     8     -.7630008106100948041009936622406837D-05,
     9     -.6960458513289174994865427908595171D+02,
     *     0.5609963963928138875634779584677664D-03,
     1     0.5395829904611113377470933965276386D+03,
     2     -.2659860268146562498570481058402658D-01,
     3     -.3323781467296539572024769709591161D+04,
     4     0.7060609230042620850985167638877586D+00,
     5     0.1709987416041518247861994425916150D+05,
     6     0.3624514798353973445293981250761490D+01,
     7     -.6259895370507063398016503656439092D+05,
     8     -.1387103344810100003330218239946402D+04,
     9     -.4645243352644281054655398179033084D+05,
     *     0.7560792621761483351291705559902131D+05,
     1     0.4925174470902424459575591673244255D+07,
     2     -.2494900096038923064709171873616375D+07,
     3     -.1018153465385417526407145097986673D+09,
     4     0.5436515885910772519460487792067979D+08,
     5     0.2031232219627830474200100253180313D+10,
     6     -.6623778488123138782477236266236053D+09,
     7     -.3644525850986525137175626394434912D+11,
     8     -.2410903948544151009800344408356494D+10,
     9     0.4915393328069255486183163388346258D+12,
     *     0.3211818308991453570396073655800765D+12,
     1     -.3665665656166517476790300940233325D+13,
     2     -.8106989286401399992507811736189859D+13,
     3     -.1833460379146093367086210567467070D+14,
     4     0.1227041410658374211391478661524409D+15,
     5     0.1006094287375741120676962682956132D+16,
     6     -.1172072327618374845695387668850939D+16,
     7     -.1595532267526969279146775436544496D+17,
     8     0.5169159923290708140805829896880781D+16,
     9     0.1520710919445406569136637738857496D+18,
     *     0.3489477929653796235425692278869155D+17,
     1     -.8876824504740654932284758300364214D+18,
     2     -.8413671901561863125818524202000709D+18,
     3     0.2208400263015928393586616526573041D+19,
     4     0.7608177682956438842724465789530046D+19,
     5     0.1002788132820023133303825514463626D+20,
     6     -.4005696419046621662647936520698353D+20,
     7     -.1162092456215445755670600298590539D+21,
     8     0.1193354354613419768863934075143491D+21,
     9     0.4703562045673740042057073190394570D+21,
     *     -.1313403597691111135869611396120490D+21,
     1     -.8967623404650124691249042302730494D+21,
     2     -.2327100125467518547454603324739639D+21,
     3     0.6072638793395031439220056926403597D+21,
     4     0.6008437837330279378540776924520012D+21/



c  rsmall=0.79999E+02, rlarge=0.16000E+03, iback=  1, m=  32 relerr=0.4198E-33
        data c2p5/
     1     0.9999999999999999999999825341491756D+00,
     2     0.2455565794511959254065300502194165D-23,
     3     0.1416666666666666666686180988404344D+01,
     4     0.7972391835188805714049824312849869D-20,
     5     -.1215277777777777852528519380327330D+00,
     6     -.9715833971318045843630580130537589D-17,
     7     0.1856674382716055322078928035534639D+00,
     8     0.4580621254329868091391432210928512D-14,
     9     -.3519945183894271270163446166991388D+00,
     *     -.1168115838777515571913718685535914D-11,
     1     0.7450550637103075143366630390386255D+00,
     2     0.1624180425953048952072415116332437D-09,
     3     -.1569390328813652847155534032561274D+01,
     4     -.5575393065354757303744145807517877D-08,
     5     0.2464183542562879987866864912091092D+01,
     6     -.2587093714178399029414964028291252D-05,
     7     0.3377063730607172258367076827932303D+01,
     8     0.6316460078384775808203755778476070D-03,
     9     -.6961383743450928208365755717152828D+02,
     *     -.8032926533123147664607963747412495D-01,
     1     0.5367022724893129505911053864524260D+03,
     2     0.6584496336883624472239230319213127D+01,
     3     -.2875061477146128526878383856371570D+04,
     4     -.3299670238086801738182760402569974D+03,
     5     -.2047987131505640512584719346961602D+05,
     6     0.4168040846458478387657610673035553D+04,
     7     0.2006515174601986643458565584229855D+07,
     8     0.9084227225642791416243759180980436D+06,
     9     -.7060808472314864273194237435824617D+08,
     *     -.9629627480567817374371843137937117D+08,
     1     0.6050395285589639485723014886142413D+09,
     2     0.5555179841094031153203788214244962D+10,
     3     0.9377983083887732214624134348983254D+11,
     4     -.2120052673007134694802583312747165D+12,
     5     -.6890474065947683367875995996375916D+13,
     6     0.5022328437587439173898751950732838D+13,
     7     0.2761555071879669325082276589009237D+15,
     8     -.2927864921253164408238673774207145D+14,
     9     -.7302922919252041291451376617031395D+16,
     *     -.3247880009359819634881446594680748D+16,
     1     0.1191094791730955018663645067694287D+18,
     2     0.1639430768986158138396556463904135D+18,
     3     -.4693732164821063610302578255669360D+18,
     4     -.4481478098877805091972594305205614D+19,
     5     -.3558078414688037868280761131220356D+20,
     6     0.7977296516127768971011194267295123D+20,
     7     0.1185549052792275765742354207244859D+22,
     8     -.8596872626126121960582183601157319D+21,
     9     -.2090031626368795382225602005995494D+23,
     *     0.2172696875427990119488912910680435D+22,
     1     0.2323308892858788510701870830556683D+24,
     2     0.1038093979197892829567031535742265D+24,
     3     -.1496921113618051285760458439351667D+25,
     4     -.2066817729016043678384828065872100D+25,
     5     0.2123253176639486320836844255547582D+25,
     6     0.2052728894756908785681499029951750D+26,
     7     0.5283297152386508576038773468127916D+26,
     8     -.1180901554072080877026064210997690D+27,
     9     -.4781701085724125318775525116101264D+27,
     *     0.3459733519230651532071419641573234D+27,
     1     0.1734858594998296693283591706910936D+28,
     2     -.1785675332860018557817673900010685D+27,
     3     -.2287348059360002474882582449107721D+28,
     4     -.1024868556508061976785923067938232D+28/


c  rsmall=0.16000E+03, rlarge=0.32000E+03, iback=  1, m=  30 relerr=0.5177E-33
        data c2p6/
     1     0.1000000000000000000000001128786282D+01,
     2     0.1738589990507264797698733858389878D-23,
     3     0.1416666666666666666666510635479129D+01,
     4     -.3662319858320002030191416444783966D-20,
     5     -.1215277777777777792600037651003255D+00,
     6     0.2779434409222591064249213696597486D-17,
     7     0.1856674382716064320414007553310956D+00,
     8     -.9140520214017920007415859112349080D-15,
     9     -.3519945183906251280669312604829753D+00,
     *     0.1281378547246691711896977345508013D-13,
     1     0.7450550641181716825981926266943552D+00,
     2     0.1084276927313592846058562554228256D-09,
     3     -.1569390402795364633785598054966816D+01,
     4     -.4806221956640310648072172738502133D-07,
     5     0.2464189579654389625496239797938122D+01,
     6     0.1157437543150080974539674418474170D-04,
     7     0.3377614069524871525414359399805011D+01,
     8     -.1749466537287263758087953381269460D-02,
     9     -.6986782182192537986047046520460265D+02,
     *     0.1489495072763442127635799762259383D+00,
     1     0.5784940164079080123376967749217177D+03,
     2     0.4726854340152673920415175474000459D+00,
     3     -.7057701200627652626255222833990629D+04,
     4     -.2231740966725392139543494282574282D+04,
     5     0.2229995653797430466946766317425139D+06,
     6     0.3713396537990435032878603623205085D+06,
     7     0.6236558533571968784912848739657447D+06,
     8     -.3631603482362922842998773806202514D+08,
     9     -.1411866484006197753681008224418307D+10,
     *     0.2336501500602765932608189045994838D+10,
     1     0.1581243381199808302458014655517107D+12,
     2     -.8702527746905716532731444707213867D+11,
     3     -.1049472645763027789497939210341605D+14,
     4     -.2149316498767905576777739688551151D+12,
     5     0.4590710868652159069941045180773885D+15,
     6     0.2774124367287902905025422389778407D+15,
     7     -.1161456299579314742738967093404515D+17,
     8     -.2102784314305329622857185711376879D+17,
     9     -.1639601854723879697435465494593576D+17,
     *     0.9391608506249634994075037418698991D+18,
     1     0.1637067423563560841677976513337190D+20,
     2     -.2736802624131828138030215287774113D+20,
     3     -.8140758801497033340534029889543530D+21,
     4     0.4559822998139069372645601677492147D+21,
     5     0.2328977438753204848686316890983576D+23,
     6     0.2351910605558063751809106893571424D+21,
     7     -.4220670346319389110625391684860361D+24,
     8     -.2474777499021279861143860955484750D+24,
     9     0.4223648843946355617171382239257159D+25,
     *     0.7364646418101188234961141460158164D+25,
     1     -.1653093336348317309565395594069257D+24,
     2     -.1185191571998512312701880185207127D+27,
     3     -.6332042524340223124683425473657204D+27,
     4     0.1112449312816255793256222129339195D+28,
     5     0.8639801076742042252743264410587550D+28,
     6     -.5119670321708432725847498207160919D+28,
     7     -.5094596660388323286636568789847172D+29,
     8     0.8668062066470486607656608030393045D+27,
     9     0.1101624357396622486226724330599976D+30,
     *     0.6024283472961376904071855415202592D+29/
        
c     
c        if z is not in the right upper quadrant - bomb out
c
        ier=0
        com=z
        if( (rea(1) .ge. 0) .and. (rea(2) .ge. 0) ) goto 1400
        ier=4
        return
 1400 continue
c

        done=1
        thresh0=1**2
        thresh1=5**2
        thresh2=10**2
        thresh3=20**2
        thresh4=40**2
        thresh5=80**2
        thresh6=160**2
        thresh7=320**2

c
c       check if if the user-specified z is in one of the 
c       intermediate regimes 
c
        d=z*dconjg(z)
        if( (d .le. thresh0) .or. (d .gt. thresh7) ) goto 3400
c
c        the user-specified z is in one of the intermediate regimes.
c        act accordingly
c
c
        if(d .gt. thresh1) goto 1900
c
c       z is in the first intermediate regime: its absolute value is 
c       between 1 and 5. act accordingly
c
c       . . . evaluate the expansion
c
        nu=3*(z/2)**toth
c 
        cd=done/nu
c
        m=63
        call abram2p(c2p0,m,cd,j2)
        j2=dc*j2*(nu**27)/3
        if (ifexpon .eq. 1) j2=j2*exp(-nu)
        
        return
 1900 continue
c
        if(d .gt. thresh2) goto 2000
c
c       z is in the first intermediate regime: its absolute value is 
c       between 5 and 10. act accordingly
c
c       . . . evaluate the expansion
c
        nu=3*(z/2)**toth
c 
        cd=done/nu
c
        m=48
        call abram2p(c2p1,m,cd,j2)
        j2=dc*j2*nu/3
        if (ifexpon .eq. 1) j2=j2*exp(-nu)

        return
 2000 continue
c
        if(d .gt. thresh3) goto 3000
c       z is in the second intermediate regime: its absolute value is
c       between 10 and 20. act accordingly.
c
        nu=3*(z/2)**toth
c 
        cd=done/nu
c
        m=38
        call abram2p(c2p2,m,cd,j2)
        j2=dc*j2*nu/3
        if (ifexpon .eq. 1) j2=j2*exp(-nu)

        return

        return
 3000 continue
c
        if(d .gt. thresh4) goto 3100
c       z is in the third intermediate regime: its absolute value is
c       between 20 and 40. act accordingly.
c
        nu=3*(z/2)**toth
c 
        cd=done/nu
c
        m=34
        call abram2p(c2p3,m,cd,j2)
        j2=dc*j2*nu/3
        if (ifexpon .eq. 1) j2=j2*exp(-nu)

        return
 3100 continue
c
        if(d .gt. thresh5) goto 3200
c       z is in the fourth intermediate regime: its absolute value is
c       between 40 and 80. act accordingly.
c
        nu=3*(z/2)**toth
c 
        cd=done/nu
c
        m=32
        call abram2p(c2p4,m,cd,j2)
        j2=dc*j2*nu/3
        if (ifexpon .eq. 1) j2=j2*exp(-nu)

        return
 3200 continue
        
        if(d .gt. thresh6) goto 3300
c       z is in the fourth intermediate regime: its absolute value is
c       between 80 and 160. act accordingly.
c
        nu=3*(z/2)**toth
c 
        cd=done/nu
c
        m=32
        call abram2p(c2p5,m,cd,j2)
        j2=dc*j2*nu/3
        if (ifexpon .eq. 1) j2=j2*exp(-nu)

        return
 3300 continue
        if(d .gt. thresh7) goto 3400
c       z is in the fourth intermediate regime: its absolute value is
c       between 160 and 320. act accordingly.
c
        nu=3*(z/2)**toth
c 
        cd=done/nu
c
        m=30
        call abram2p(c2p6,m,cd,j2)
        j2=dc*j2*nu/3
        if (ifexpon .eq. 1) j2=j2*exp(-nu)

        return
 3400 continue
c
c        z is either in the local regime or the asymptotic one.
c        if it is in the local regime - act accordingly.
c
        if(d .ge. 102400.d0) goto 4000
        call abram2series(z,j2,ifexpon)
        return
c
c        z is in the asymptotic regime. act accordingly.
c
 4000 continue
        call abram2asym(z,j2,ifexpon)
        return
        end
c
c
c
c
c
