c
c
c
c
c
ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
c
c
c        this is the end of the debugging code and the beginning of the
c        Abramowitz function code proper.
c
c
ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
c
c
        subroutine abram0(z,j0,ifexpon)
        implicit real *8 (a-h,o-z)
        complex *16 z,j0,j0u,com,zu,ima
        real *8 rea(2)
        equivalence (rea(1),com)
        data ima/(0.0d0,1.0d0)/,
     $     pi/3.141592653589793238462643383279502884197d0/
c
c        this subroutine evaluates the Abramowitz function J_0
c        for a user-specified complex number z with Re(z)>=0.
c        
c        The code is reasonably accurate (32-digit relative accuracy
c        when ifexpon=0) 
c        and reasonably fast (O(1) cost for any z).
c
c        When ifexpon=1, that is, the Abramowitz function is evaluated
c        honestly. The subroutine will lose accuracy gradually
c        simply due to the ill-conditioning of evaluating the 
c        exponential factor exp(-nu) with nu=3(z/2)**(2/3).
c        The condition number of evaluating exp(-nu) is abs(nu). 
c        Thus, the subroutine will lose an extra log_{10}abs(nu) 
c        digits if the function is evaluated honestly.
c
c                      input parameters:
c
c  z - the complex number for which the Abramowitz function
c        J_0 is to be evaluated
c
c  ifexpon - the integer parameter telling the subroutine whether
c        to calculate the actual values of the Abramowitz function,
c        or the values of the Abramowitz function scaled by e^{nu}.
c        Permitted values: 0 and 1. 
c    ifexpon = 1 will cause the subroutine to evaluate the Abramowitz 
c        function honestly
c    ifexpon = 0 will cause the subroutine to scale the Abramowitz 
c        function by e^{nu}, where nu=3(z/2)^(2/3).
c        
c                      output parameters:
c
c  j0 - the said Abramowitz function
c        
c       
c        . . . if z in the upper half-plane - act accordingly
c
        com=z 
        if(rea(2) .lt. 0) goto 1400
        call abram0ur(z,ier,j0,ifexpon)
        return
 1400 continue
c
c       z is in the right lower quadrant. compute 
c       j0 at the points zu obtained from z by reflection
c       in the x axis.
c
        zu=dconjg(z)
c
        call abram0ur(zu,ier,j0u,ifexpon)
        j0=dconjg(j0u)

        return
        end
c
c
c
c
c
        subroutine abram0p(p,m,z,f)
        implicit real *8 (a-h,o-z)
        complex *16 p(1),z,f
c
c       evaluate a polynomial at a point
c
        f=p(m)
        do 1200 i=m-1,1,-1
        f=f*z+p(i)
 1200 continue
        return
        end
c
c
c
c
c
        subroutine abram0pr(p,m,z,f)
        implicit real *8 (a-h,o-z)
        real *8 p(1),z,f
c
c       evaluate a polynomial at a point
c
        f=p(m)
        do 1200 i=m-1,1,-1
        f=f*z+p(i)
 1200 continue
        return
        end
c
c
c
c
c
        subroutine abram0pc(p,m,z,f)
        implicit real *8 (a-h,o-z)
        real *8 p(1)
        complex *16 z,f
c
c       evaluate a polynomial at a point
c
        f=p(m)
        do 1200 i=m-1,1,-1
        f=f*z+p(i)
 1200 continue
        return
        end
c
c
c
c
c
        subroutine abram0asym(z,j0,ifexpon)
c
c        evaluate the asymptotic expansion for J_0 at
c        the user-supplied point z.
c
        implicit real *8 (a-h,o-z)
        dimension c(51)
        complex *16 z,j0,nu,pp,cd
cccc        complex *16 nui,d(51),small,tmp
        data ima/(0.0d0,1.0d0)/,
     $     dc/1.0233267079464884884795516248892648607073764377510d0/,
     1     toth/0.66666666666666666666666666666666666666666666666667d0/
c
        data c/
     1     +1.0000000000000000000000000000000000000000000000000D0,
     2     -8.3333333333333333333333333333333333333333333333333D-2,
     3     +8.6805555555555555555555555555555555555555555555556D-2,
     4     -1.1815200617283950617283950617283950617283950617284D-1,
     5     +1.7968950938786008230452674897119341563786008230453D-1,
     6     -2.4323723770790466392318244170096021947873799725652D-1,
     7     +1.1651670400406997789971040999847584209724127419601D-2,
     8     +2.3768020513211179420375450896712899456383681349388D0,
     9     -1.6826224328954810645913841153110128876018222154482D1,
     *     +9.0244569395586014925680730379955943682679105802275D1,
     1     -4.0800203045505824157718080242125269105862906491763D2,
     2     +1.3696211083337200294199168266699217000901183623254D3,
     3     -8.6935525011723254772789760162494159324235075497001D1,
     4     -5.9316121034919022731233929247252308510931227208856D4,
     5     +7.7598950258393226012201488230445114882234011840356D5,
     6     -7.2653688041073530680389942768295103179506018412275D6,
     7     +5.4642524775359685215306011901154861821666249747786D7,
     8     -2.9278452929635176402724096737872829805890796250035D8,
     9     +2.0389307909491662278047407034415495674585422255388D7,
     *     +2.9518755444497944432256993104951175749915753740843D10,
     1     -5.6330525855958828035571886442279391681643563542705D11,
     2     +7.5270725327661296589338202094296370333138602359484D12,
     3     -7.9191623987328084663763444905047039037324110644853D13,
     4     +5.8276077180856447252490832066070780156520803410323D14,
     5     -4.2484620470726986069242114172615216088979502830867D13,
     6     -1.0625288783191550279852799909229754918259580622466D17,
     7     +2.6651629420674278804798182392760401071236164770618D18,
     8     -4.6272804749758684287085925708777908985088513355305D19,
     9     +6.2564908363380160636009791499012325534653465997552D20,
     *     -5.8556352555986080237445848293897316478536224264195D21,
     1     +4.3867450023803168669774062611348523089897643264582D20,
     2     +1.6854292975785847354274755946950643648553039420638D24,
     3     -5.2388720730251025281768742008323109244910246234648D25,
     4     +1.1191241302124144133162667966067997683682427189896D27,
     5     -1.8488900631987894106931412167399413932023336176668D28,
     6     +2.1002628679846678576602112368415928179901320388185D29,
     7     -1.6020480927507280103247579187308677355719850077871D28,
     8     -8.7650823186013127645718507501445583867594067384073D31,
     9     +3.2503870329066222083050789733713187363211578259040D33,
     *     -8.2435703729613286589063297853192909520696749122770D34,
     1     +1.6092156699417117261596626665475609380593972763576D36,
     2     -2.1498797084335590088262994611677638875407793347984D37,
     3     +1.6610550370176307805518636041121334695526509186536D36,
     4     +1.2272250233507804383699234571612957959655153064238D40,
     5     -5.2873009020066766917001325243275047249938276315390D41,
     6     +1.5524426716619640353051063885665732698380388400298D43,
     7     -3.4962332152476886123311371245365176231648936075726D44,
     8     +5.3701996041102499664608084219671338270003145345903D45,
     9     -4.1890963727257743240678590760882807758499527185278D44,
     *     -4.0187109779190962123954363104512119896049721137450D48,
     1     +1.9725199443805826208093188430039806942969915161978D50/

c
        m=32
        nu=3*((z/2)**toth)
cccc        print *, nu
        
        pp=c(m+1)
        cd=1/nu
c
        do 1800 i=m,1,-1
           pp=pp*cd+c(i)
 1800 continue
c
c     summing from right to left
c
cccc        d(1)=c(1)
cccc        nui=cd
cccc        do i=2,m
cccc           d(i)=c(i)*nui
cccc           nui=nui*cd
cccc        enddo
cccc        call prin2('d=*',d,2*m)
cccc        pause
cccc
cccc        pp=0
ccccc
cccc        do 1900 i=m,1,-1
cccc           pp=pp+d(i)
cccccc        call prinf('i=*',i,1)
cccccc        call prin2('cd=*',cd,2)
cccc 1900 continue


c
c     Neumaier Summation technique
c
c      
cccc        pp=d(m)
cccc        small=0
cccc        do i=m-1,1,-1
cccc           tmp=pp+d(i)
cccc           if (abs(pp) .gt. abs(d(i))) then
cccc              small = small + (pp-tmp) +d(i)
cccc           else
cccc              small = small + (d(i)-tmp) + pp
cccc           endif
cccc           pp=tmp
cccc        enddo
cccc        pp=pp+small

      
        j0=dc*pp
        if (ifexpon .eq. 1) j0=j0*exp(-nu)
      
c
        return
        end
c
c
c
c
c
        subroutine abram0series(z,j0,ifexpon)
        implicit real *8 (a-h,o-z)
        dimension a(25),b(50)
        complex *16 z,j0,lnz,z2,c1,c2,nu
c
c
c        this subroutine evaluates the Abramowitz function J_0
c        for a user-specified complex number z in the local regime,
c        i. e. for cdabs(z) < 1, using the series expansion 
c
c                      input parameters:
c
c  z - the complex number for which the Abramowitz function
c        J_0 is to be evaluated
c
c                      output parameters:
c
c  j0 - the said Abramowitz function
c        
        data a/
     2     -2.0000000000000000000000000000000000000000000000000D0,
     4     +3.3333333333333333333333333333333333333333333333333D-1,
     6     -8.3333333333333333333333333333333333333333333333333D-3,
     8     +6.6137566137566137566137566137566137566137566137566D-5,
     *     -2.2964432686654908877131099353321575543797766019988D-7,
     2     +4.1753513975736197958420180642402864625086847309070D-10,
     4     -4.4608455102282262776089936583763744257571418065245D-13,
     6     +3.0345887824681811412306079308682819222837699364112D-16,
     8     -1.3945720507666273626978896741122619128142325075419D-19,
     *     +4.5307733943035326923258274012744051748350633773292D-23,
     2     -1.0787555700722696886490065241129536130559674707927D-26,
     4     +1.9381163673594496741807519297753388664318495702348D-30,
     6     -2.6918282879992356585843776802435262033775688475483D-34,
     8     +2.9496255621293399721503152314743876872425694143637D-38,
     *     -2.5946741398041343878873286694883776277643995552108D-42,
     2     +1.8599814622251859411378700139701631740246591793626D-46,
     4     -1.1008413010328988761469401124349924088687613514220D-50,
     6     +5.4416277856297522300886807337369866973245741543351D-55,
     8     -2.2696145252042676969005174898802914153005397707437D-59,
     *     +8.0602831351810060973809130260682272011525668397745D-64,
     2     -2.4574033948722579565185710445329960979123679389556D-68,
     4     +6.4794689523605388296117994107815116224024888966821D-73,
     6     -1.4874813940221622657511017931087033109280277540592D-77,
     8     +2.9913554157224837424106137495650229476089525681922D-82,
     *     -5.2993116066512254506990748114459731923344539544221D-87/


        data b/
     1     -1.7724538509055160272981674833411451827975494561224D0,
     2     +2.6835300529540141818046372975279270687352199218023D-1,
     3     +1.7724538509055160272981674833411451827975494561224D0,
     4     -4.8916994532701134747452173273657656225669810980782D-1,
     5     -9.8469658383639779294342637963396954599863858673466D-2,
     6     +1.8062581966508617020196376651747747389750786078529D-2,
     7     +1.3129287784485303905912351728452927279981847823129D-3,
     8     -1.7484790424414750217590976682541044161681777814907D-4,
     9     -6.6986162165741346458736488410474118775417590934331D-6,
     *     +6.9003789666065488683377121580855861174433144031200D-7,
     1     +1.6539793127343542335490490965549165129732738502304D-8,
     2     -1.3760791254942414610313518269752785366263098109209D-9,
     3     -2.2782084197442895778912521991114552520293028240088D-11,
     4     +1.5788316272729113463256804298998502922367229103736D-12,
     5     +1.9257890276790275383696130170003848284271367912162D-14,
     6     -1.1376169807979124663099205130412199832946006968810D-15,
     7     -1.0698827931550152990942294538891026824595204395646D-17,
     8     +5.4843743696166248199349085478203605689667738841116D-19,
     9     +4.1133517614571906924038041287547200402134580529203D-21,
     *     -1.8559861431739840375659942328929793988883889143369D-22,
     1     -1.1394326209022688898625496201536620610009579093962D-24,
     2     +4.5782594964725351387196015175904345783282354703001D-26,
     3     +2.3488613088069859613740458053054258111749286938697D-28,
     4     -8.4858616614283542478410380200101148500491157350946D-30,
     5     -3.7001595916934246398456928249927942835143804251256D-32,
     6     +1.2117911129725953297671292719466305523484783123273D-33,
     7     +4.5540425743919072490408527076834391181715451386161D-36,
     8     -1.3614587100797068436089114073569627266007024262949D-37,
     9     -4.4621228438094329306690698683945121675206203592163D-40,
     *     +1.2251043162587514264946119322111213874375314892150D-41,
     1     +3.5371564358378382327935551869952534027115500271235D-44,
     2     -8.9661079601251540679735809204581336146170020493923D-46,
     3     -2.3004399296552017643038210113132501318363358657151D-48,
     4     +5.4088067448668990363123941347584874670499667550280D-50,
     5     +1.2426078591558373922669588998613137426869420762248D-52,
     6     -2.7212134078679352722394275878057129964699284360240D-54,
     7     -5.6354097920899654978093374143370237763580139511331D-57,
     8     +1.1537169567346428814806714356462056917304300648502D-58,
     9     +2.1665486878974147467645755312510183293060681831276D-61,
     *     -4.1603871750997294513790005254480434138851137231516D-63,
     1     -7.1221192896035987730590911612459511154045633896369D-66,
     2     +1.2866914079068940687555041643093440605713949697750D-67,
     3     +2.0175403783472419401884057565638228705715315117523D-70,
     4     -3.4385598809545936748655294023243283336297338499428D-72,
     5     -4.9597826302847778656482761113226384546229694472500D-75,
     6     +7.9945152260109435685488335243002132856655007073749D-77,
     7     +1.0649023360783205293930812906758214610033214057434D-79,
     8     -1.6270837932665421600479538444749642087798151832182D-81,
     9     -2.0086433078284301520165257482190686981351316692007D-84,
     *     +2.9153425827952240186139516061052134687601954185701D-86/

c
c        evaluate j0
c
        m=29
        c1=b(m)
        do k=m-1,1,-1
           c1=c1*z+b(k)
        enddo

        m2=15
        c2=a(m2)
        z2=z**2
        do k=m2-1,1,-1
           c2=c2*z2+a(k)
        enddo

        j0=-(c1+c2*z*log(z))/2

        if (ifexpon .eq. 1) return

        nu=3*(z/2)**(2.0d0/3)
        j0=j0*exp(nu)
c
        return
        end
c
c
c
c
c
        subroutine abram0ur(z,ier,j0,ifexpon)
        implicit real *8 (a-h,o-z)
        complex *16 z,com,ima,cd,j0,nu
        dimension rea(2)
        equivalence (rea(1),com)
        real *8 c0p0(126)
        real *8 c0p1(96)
        real *8 c0p2(76)
        real *8 c0p3(68)
        real *8 c0p4(64)
        real *8 c0p5(64)
        real *8 c0p6(60)
        data ima/(0.0d0,1.0d0)/,
     $     dc/1.0233267079464884884795516248892648607073764377510d0/,
     1     toth/0.66666666666666666666666666666666666666666666666667d0/
c
c        this subroutine evaluates the Abramowitz function J_0
c        for a user-specified complex number z in the upper right quadrant.
c        it is reasonably accurate (32-digit relative accuracy) 
c        and reasonably fast.
c        
c
c                      input parameters:
c
c  z - the complex number for which the Abramowitz function
c        J_0 is to be evaluated
c
c                      output parameters:
c
c  ier - error return code. 
c         ier=0 means successful conclusion
c         ier=4 means that z is not in the upper right quadrant
c  J0 - the said Abramowitz function
c        




c  rsmall=0.99902E+00, rlarge=0.50010E+01, iback= 27, m=  63 relerr=0.4957E-33
        data c0p0/
     1     0.1379832299044118440822537900762248D-35,
     2     -.4461581057089485830200515584320564D-34,
     3     -.4673712197680637772498363116125136D-32,
     4     0.7652850382448158437515039105735451D-32,
     5     0.7765641488694483302084153251370454D-30,
     6     -.4298342058586280584279100683507697D-30,
     7     -.5769664921249245336260776421732523D-28,
     8     -.6404949997017769139932293360773062D-30,
     9     0.2394264934793999007204932932624171D-26,
     *     0.1394262624301368809834211826269085D-26,
     1     -.5276592671584157206834309490867646D-25,
     2     -.9053682113197454868771198931635965D-25,
     3     0.4030129617098046810485521391412553D-25,
     4     0.3250703829675798003619574038991402D-23,
     5     0.4095691026688766020434478443293817D-22,
     6     -.7455598888799802006409436383524699D-22,
     7     -.1629007432143344195403962635296073D-20,
     8     0.1008503716795869429528460405649681D-20,
     9     0.3769141921182421416597710272757177D-19,
     *     -.1543186288555170973621476028770634D-20,
     1     -.5854516133036717343749217978089224D-18,
     2     -.2986467507591324929721041270903828D-18,
     3     0.5670128703996218580798761932911971D-17,
     4     0.8516828448766594195543797576997986D-17,
     5     -.1099332953215516334075330040101692D-16,
     6     -.1430584594756016599187608629894222D-15,
     7     -.7652276367755915696228407156384664D-15,
     8     0.1656373759405811483110247858042617D-14,
     9     0.1709947276588551877143086725472426D-13,
     *     -.1246595600269391938338799371098414D-13,
     1     -.2232049649320563509535671602487238D-12,
     2     0.2770782043751127102386988115370355D-13,
     3     0.2042421662479799080255366232881291D-11,
     4     0.8181500577437877878785841036726418D-12,
     5     -.1261813829152342703369358217346974D-10,
     6     -.1536443080371121568030200564383722D-10,
     7     0.3113094492461487593516933937619440D-10,
     8     0.1635666009779703315927953135243865D-09,
     9     0.3930630285035741644555974109963265D-09,
     *     -.1235013397370098327920084880849597D-08,
     1     -.6746334468817067934402062817853401D-08,
     2     0.6547567320003202820475591647227145D-08,
     3     0.6116155069436398643181288616944117D-07,
     4     -.1779302049249593160542230648754273D-07,
     5     -.3960414613738940661646740565931173D-06,
     6     -.7954843048874226209218851895134987D-07,
     7     0.1879855299095763821922609460171448D-05,
     8     0.1495609621977004917769245020773607D-05,
     9     -.5646241053221157601584857135322596D-05,
     *     -.1217147406863418270833837343086894D-04,
     1     -.1272647384402667256834640162049723D-05,
     2     0.7046503304282901055063522333302484D-04,
     3     0.1000153135446773610218637039034947D+01,
     4     -.3129958267048705316278660944931114D-03,
     5     -.8457510407798314228209015192950373D-01,
     6     0.1043831732668162968713097566190049D-02,
     7     0.9357720204869156900816995165884853D-01,
     8     -.2162713636172566675484510977015337D-02,
     9     -.1474054664563309570374732450813550D+00,
     *     -.1286471147945280497973233591796599D-02,
     1     0.2861730057019357155087366561489525D+00,
     2     0.3824415584111597405872228417427666D-01,
     3     -.5887273318406034600139409218027855D+00,
     4     -.2203473076778525079785201899096202D+00,
     5     0.1114769967203470078024468146663300D+01,
     6     0.8726912019213080685067177591009933D+00,
     7     -.1640241608310241062734352980361385D+01,
     8     -.2716038292919062505722000102136849D+01,
     9     0.9700465409245085746419881339200204D+00,
     *     0.6864292752050258173982152334021824D+01,
     1     0.4176017900715915827229602110096123D+01,
     2     -.1398452141452598590417750496733778D+02,
     3     -.1982780184323997123851146168183972D+02,
     4     0.2169095381781446522645805512884987D+02,
     5     0.5259116359522068163934692057838343D+02,
     6     -.2011861976765639828454463605830966D+02,
     7     -.1016396860259225410668042132895520D+03,
     8     -.1126564667372606819880586558557719D+02,
     9     0.1453682836612205178919373174403241D+03,
     *     0.9828228591757957824229676841022987D+02,
     1     -.1324265418915624905285467710180278D+03,
     2     -.2508937835542538961439670718865273D+03,
     3     -.4391282820815177475881256063432271D+01,
     4     0.4310180163964428804639987518477540D+03,
     5     0.2998280451097433454411964112075088D+03,
     6     -.5357248910427166960914752498077925D+03,
     7     -.6939895898745661779696668956327531D+03,
     8     0.4322617188876366569474913626977838D+03,
     9     0.1014165857189286746180110892868060D+04,
     *     -.5145742558590849040664802797137639D+02,
     1     -.1052009529561579915100785592181028D+04,
     2     -.5187116004350156248051512607874744D+03,
     3     0.7112266688811384236033472900610464D+03,
     4     0.1035426585342032513589485403184188D+04,
     5     -.1108327486548796970233802670816250D+03,
     6     -.1238202080569363941758316703543936D+04,
     7     -.4668504009490054910176620245530897D+03,
     8     0.1031904692385557962194103498901433D+04,
     9     0.7640616723667761682067147785192551D+03,
     *     -.5576242625523773718826515096638939D+03,
     1     -.7159669523769628599058270794593185D+03,
     2     0.8182623736408117355623816268171185D+02,
     3     0.4578826114445307173012638604876245D+03,
     4     0.1957121584079016470225060619087558D+03,
     5     -.1871664884954483299350484592641957D+03,
     6     -.2471262645210415927626432496754808D+03,
     7     0.2213376876925179350927148877961372D+02,
     8     0.1710589936461554102333071656625008D+03,
     9     0.3241959391078223694325903516604013D+02,
     *     -.7850574461407142351327729928858490D+02,
     1     -.2893105411288534830794757601221854D+02,
     2     0.2236787987554187369148755035246849D+02,
     3     0.1342929615840810556507798276072179D+02,
     4     -.1844170981473034781549257242166694D+01,
     5     -.3927139631929749638587224570017549D+01,
     6     -.1595112839316387545970641508201262D+01,
     7     0.6685118132317124469057534240875928D+00,
     8     0.8576178729831822452263509017863404D+00,
     9     -.3038691733724202372668324773472854D-01,
     *     -.2176526396627029829391554076128925D+00,
     1     -.1232897731948836758046490357820497D-01,
     2     0.3040854328528079761059732585397104D-01,
     3     0.2540011069934928958310272532465436D-02,
     4     -.1976270118331406226342942457071709D-02,
     5     -.1541098300483573407547552575103189D-03,
     6     0.2114658855115848690477088903816615D-04/

c  rsmall=0.49990E+01, rlarge=0.10001E+02, iback=  2, m=  48 relerr=0.6921E-33
        data c0p1/
     1     -.1957957935939715244214722696079914D-18,
     2     0.1017697834940133538102697410948833D-17,
     3     0.1000000000000000195913879882943745D+01,
     4     -.2376950130495072164396272236580633D-15,
     5     -.8333333333337509323777288940636415D-01,
     6     0.1684861650336602663438678224209530D-13,
     7     0.8680555555984348655867632012320137D-01,
     8     0.4861342837581299983287527218662522D-12,
     9     -.1181520064231714401106996892087564D+00,
     *     -.1739733541773921913968956897873461D-09,
     1     0.1796895170728431811945920500212862D+00,
     2     0.1507936221109417916257114113096972D-07,
     3     -.2432372238640559658367481846551097D+00,
     4     -.7687204630373416173520145745939972D-06,
     5     0.1163748286544867597787840445653654D-01,
     6     0.2572560814497997118842525120260348D-04,
     7     0.2377605279702034533416341853955887D+01,
     8     -.5318218727834354464255581186406785D-03,
     9     -.1685358275535597150969414715694060D+02,
     *     0.2957423421221762231007654773099222D-02,
     1     0.9089200439065943236712248498992555D+02,
     2     0.2464400234462571310700198395487390D+00,
     3     -.4184900898186151740419357435811769D+03,
     4     -.1142583833640549900722105216549241D+02,
     5     0.1457511063268095076062586200636940D+04,
     6     0.2983224849007920803507364232022342D+03,
     7     0.8052842902187678885484550951352074D+03,
     8     -.5544381715318643718710100268643522D+04,
     9     -.1105798786343894630471896932190814D+06,
     *     0.7599738922834066521228797101016198D+05,
     1     0.1926137296752432276783867534045483D+07,
     2     -.7183670941961152256943779543022193D+06,
     3     -.2523044115436468756613666823421217D+08,
     4     0.2851843728216144780833590662933084D+07,
     5     0.2701983563517663785667481690667355D+09,
     6     0.4839879384023975265297826110125522D+08,
     7     -.2327932110953998490353355059721480D+10,
     8     -.1306079699490697947608748905432959D+10,
     9     0.1502714159912790225899366135581788D+11,
     *     0.1825224007258213763653481548734551D+11,
     1     -.5466666519508799948058612700536422D+11,
     2     -.1841158898220843308185738973962635D+12,
     3     -.1936322132308215727772465451251986D+12,
     4     0.1423858483178983694412110714897430D+13,
     5     0.5424168862907264041550778458942295D+13,
     6     -.8314026850699676755123621407608947D+13,
     7     -.5458124810947223815416057514348696D+14,
     8     0.3228446895712095806973886036738953D+14,
     9     0.3741363777830998171835612592540093D+15,
     *     -.2341868981273511125123616264599561D+14,
     1     -.1872621973264374338912779213221129D+16,
     2     -.8365589981517127523963610785164738D+15,
     3     0.6354197690362531542670040148864532D+16,
     4     0.8211558615140045937164135594275686D+16,
     5     -.7658304675014978906234025881306829D+16,
     6     -.4799628948875995598033849710621172D+17,
     7     -.7195218570912647386550000201321843D+17,
     8     0.1974662838639698614163390718867620D+18,
     9     0.6373409696768571311274043574821718D+18,
     *     -.5446343226621091102506732036180678D+18,
     1     -.3026134296783619412919992508396858D+19,
     2     0.5720376130035167300840131884869069D+18,
     3     0.9805259793409552310964925675228104D+19,
     4     0.3458683291681031130782880904103485D+19,
     5     -.2074050844521799174622068067254904D+20,
     6     -.2460400727080145715370645056364948D+20,
     7     0.1486070507930655353348616166747422D+20,
     8     0.8981121416255094461896564125601022D+20,
     9     0.8644232354333392204200861461928035D+20,
     *     -.2180459271925377298164406981401959D+21,
     1     -.4373721483974350876951096342636044D+21,
     2     0.3304549347703377260723055923554333D+21,
     3     0.1150941340331276895644014457691682D+22,
     4     -.1106785561494445087010603039855587D+21,
     5     -.1960429118496356449180228997436480D+22,
     6     -.9715847786091659772779978802230230D+21,
     7     0.1927088822006715730852286553537187D+22,
     8     0.3143802056393110464951382341703836D+22,
     9     0.8544221206206651062115964797243940D+20,
     *     -.5484346958848334772909294829057269D+22,
     1     -.3935619156568052254235533542733709D+22,
     2     0.5933203535906335193994742290667807D+22,
     3     0.7287052207244115776328863964453994D+22,
     4     -.3172031549060629941895043750820517D+22,
     5     -.7375781389633831238234275962139125D+22,
     6     -.1252332302136976015839629190193225D+22,
     7     0.4226337196342248603301681892197855D+22,
     8     0.3943254959816765885063816234889127D+22,
     9     -.8171219090495098460670070566446559D+21,
     *     -.3426373862862818193695197363659658D+22,
     1     -.5516148821340325767113305948868503D+21,
     2     0.1489931734606247010016652144509929D+22,
     3     0.3825151343339987338989316975268529D+21,
     4     -.2762455762576940572548735505106734D+21,
     5     -.6920725967531965537020684590867190D+20,
     6     0.2312074376340932865112700820344686D+19/


c  rsmall=0.99990E+01, rlarge=0.20001E+02, iback=  1, m=  38 relerr=0.1082E-32
        data c0p2/
     1     0.9999999999999999998319577456162005D+00,
     2     -.2099812829823246437724307225113200D-18,
     3     -.8333333333333331614935295042318793D-01,
     4     0.9991414411898592555980982353772437D-16,
     5     0.8680555555556166296362759965357147D-01,
     6     -.1768942081790672731105610516647530D-13,
     7     -.1181520061745074096711603369251516D+00,
     8     0.1515836161474761057367852382444435D-11,
     9     0.1796895095812645267173668320456415D+00,
     *     -.4720264014082250337126665121957818D-10,
     1     -.2432372510059727413486870690731641D+00,
     2     -.3482732941551654166361205898847708D-08,
     3     0.1165223627769606525563005667941316D-01,
     4     0.5255531989935210026623797478742153D-06,
     5     0.2376790167869492490231273889612465D+01,
     6     -.3427548713664381038374422254280194D-04,
     7     -.1682644217711405512283531283304152D+02,
     8     0.1436705280305854031968665466564834D-02,
     9     0.9027422745664794571425641836710487D+02,
     *     -.4071495942190723972364514671564556D-01,
     1     -.4093657353552248831678438546561689D+03,
     2     0.6897559518535674299634276633889005D+00,
     3     0.1410558012288488800313962239577633D+04,
     4     -.1053735987250252519254566937125072D+00,
     5     -.9628938382629258735635669699413200D+03,
     6     -.4279078449319312388886581852755731D+03,
     7     -.4643248819127770923658931871572392D+05,
     8     0.1626427913812951016159668688941235D+05,
     9     0.6832439749686428241774565017995074D+06,
     *     -.3852080238614107187051275620502608D+06,
     1     -.8495337840454750890438502823268446D+07,
     2     0.6694232028468327305853183305480864D+07,
     3     0.1123860639992139695016765122025519D+09,
     4     -.8807772497255175028396501991532811D+08,
     5     -.1490686322921386730389082505153025D+10,
     6     0.8481867035988891832992075881296444D+09,
     7     0.1773259666325066931420667053536772D+11,
     8     -.4945779259240953006666683472318549D+10,
     9     -.1766623264391155592498176864237636D+12,
     *     -.6716839714992014231766382101459128D+10,
     1     0.1409318835855085731346817019325909D+13,
     2     0.5836673923581711356706539699495583D+12,
     3     -.8436144466884484931739876998974589D+13,
     4     -.8337675291909896938939635411254818D+13,
     5     0.3088571543875493185839557340763631D+14,
     6     0.7727294658993430173336388937889713D+14,
     7     0.2597581783932490086717040277863512D+14,
     8     -.5259659831609537365939331607507243D+15,
     9     -.1421455229597240707219315829751805D+16,
     *     0.2642532448517401535669414663196539D+16,
     1     0.1247936390685380699070419295782476D+17,
     2     -.8936946431999346037375940016782347D+16,
     3     -.6934457857079985814395544342052718D+17,
     4     0.1092487016577048479783020497282211D+17,
     5     0.2712820551118040050808193505703524D+18,
     6     0.8889310766366401442410473407118635D+17,
     7     -.7171537360906531117171343468832975D+18,
     8     -.7324123782273074648853303645191903D+18,
     9     0.9220168223099015728224747722718296D+18,
     *     0.3086370987376180062969619930574733D+19,
     1     0.1729089579308556237060850056843335D+19,
     2     -.8585887575416455166925710458406506D+19,
     3     -.1294711438004633861624115065238485D+20,
     4     0.1563834880440631926711790605036641D+20,
     5     0.3648547090634805246526664484282181D+20,
     6     -.1471070145133393306893102508597222D+20,
     7     -.6158708764091370707122200036634515D+20,
     8     -.7145845891682441256357291062200885D+19,
     9     0.6229434253084009178515937784186082D+20,
     *     0.4415887739804933795984506055375520D+20,
     1     -.3004736614289536132999876114288024D+20,
     2     -.6205512260793986757597988534655146D+20,
     3     -.2194343552778993813299175271589677D+19,
     4     0.4054100084651006131992481896213981D+20,
     5     0.6222436877053430916879732113281867D+19,
     6     -.9910538283530133935941590989774877D+19/

        
c  rsmall=0.19999E+02, rlarge=0.40001E+02, iback=  1, m=  34 relerr=0.4991E-33
        data c0p3/
     1     0.9999999999999999999995830697849624D+00,
     2     0.4633957364160205143558662146051685D-21,
     3     -.8333333333333333301940548879456958D-01,
     4     -.1051041696871739731175198848231424D-18,
     5     0.8680555555555547126005594338033947D-01,
     6     -.1625820655088067624817431739312540D-16,
     7     -.1181520061728284550388375300676114D+00,
     8     0.9355923474400441905681385026229038D-14,
     9     0.1796895093872343620242749635767875D+00,
     *     -.1671954174315780384957590305039040D-11,
     1     -.2432372377335243107993604261969516D+00,
     2     0.1695094836366884924284109548836904D-09,
     3     0.1165167853639899010921780140735421D-01,
     4     -.1057506721876753906285484465740333D-07,
     5     0.2376801258985390592072243770336537D+01,
     6     0.3462046438507739183297194914579525D-06,
     7     -.1682617694212880876927135827741526D+02,
     8     0.4182244673274654437940274703039910D-05,
     9     0.9024268930005378079945366712461631D+02,
     *     -.1243589499361267880900128332765125D-02,
     1     -.4079579019501461199394326104477941D+03,
     2     0.8188233371537568853571241836515347D-01,
     3     0.1369596862809248183674863939234000D+04,
     4     -.3370874881563352442328249051082571D+01,
     5     -.1362302354002260048914744022894780D+03,
     6     0.9609649658208830046700726463154761D+02,
     7     -.5681870083573966615678548340526084D+05,
     8     -.1793420276676004173653898951522793D+04,
     9     0.6988846672106449302102355247146923D+06,
     *     0.1222937794045642614769489369854207D+05,
     1     -.5570809859194732439060657223823488D+07,
     2     0.5200887475106337927576322738199785D+06,
     3     0.2803123673810035366686811811824156D+08,
     4     -.2430796755648233043055795361256057D+08,
     5     -.3488193761305794748231647612259413D+08,
     6     0.6036498623755028424877607262449493D+09,
     7     0.6195725195097812604353458982700371D+08,
     8     -.1069530677626964977753139856230841D+11,
     9     -.2924798916449194628016014593210341D+11,
     *     0.1438338673232407673442910402732020D+12,
     1     0.7890689536104354414209080725436764D+12,
     2     -.1472557470694570024070146131803442D+13,
     3     -.1213323775505036571073507629086750D+14,
     4     0.1093169940667646264710293696198275D+14,
     5     0.1305688566362589420735287996567888D+15,
     6     -.4787556394826097048534277559152491D+14,
     7     -.1034138530372267073199932321388392D+16,
     8     -.5902901660153284175295471828742655D+14,
     9     0.5957887865285000616045082545786670D+16,
     *     0.3145535679898118676829598788783079D+16,
     1     -.2273482353591312031609791091190008D+17,
     2     -.3051110774256477140288798116324925D+17,
     3     0.3364429440329034764659819914967133D+17,
     4     0.1817616044313031739005062412018442D+18,
     5     0.2139709059053450560289126718047033D+18,
     6     -.7314371024954330324978195133936042D+18,
     7     -.1803769855882344286854080232276820D+19,
     8     0.1895430428423936850871239653927927D+19,
     9     0.6897366749380516766712687278661842D+19,
     *     -.2340926260376143571979351225418665D+19,
     1     -.1559562656294694091402792845124634D+20,
     2     -.2541941382033026770825622660313210D+19,
     3     0.1987949416443585528317491957549394D+20,
     4     0.1527625102183186304895197393891172D+20,
     5     -.1050388518927825755958755773801494D+20,
     6     -.2365793400397716148204043113962875D+20,
     7     -.1087787734357765633141550576370299D+19,
     8     0.1300905859217550055370867475541576D+20/


c  rsmall=0.39999E+02, rlarge=0.80001E+02, iback=  1, m=  32 relerr=0.6925E-33
        data c0p4/
     1     0.1000000000000000000000004783432642D+01,
     2     -.1393481944554050970476786122394776D-23,
     3     -.8333333333333333333697468525986403D-01,
     4     -.9252997046069172817337460070336625D-21,
     5     0.8680555555555555653614817594143774D-01,
     6     0.9714794085909143066939469873204413D-18,
     7     -.1181520061728395902840329858969653D+00,
     8     -.3180472727418794862314615457513654D-15,
     9     0.1796895093878446940841558091881578D+00,
     *     0.5502881346195233954506432517535460D-13,
     1     -.2432372377023592248516497740709782D+00,
     2     -.5346800483231107555497449430632004D-11,
     3     0.1165166958536514223924939695283992D-01,
     4     0.1963641784509285067975996881062275D-09,
     5     0.2376802123710407619475701873405866D+01,
     6     0.2192900582580549282205238661464600D-07,
     7     -.1682622824277017429515451206227512D+02,
     8     -.4232964268180402820701847299556484D-05,
     9     0.9024465006274030943666887431157670D+02,
     *     0.3676727805533704735224248850949709D-03,
     1     -.4079954562520352828061173966452889D+03,
     2     -.2023449506151576910650523528401580D-01,
     3     0.1368836906028660085721456647877437D+04,
     4     0.6971591623580308140423640021943043D+00,
     5     -.4238672775268015957098386342526845D+02,
     6     -.8890779869212503802142261877743919D+01,
     7     -.6095538416325968434596911867550818D+05,
     8     -.5659128870974487132611789406020477D+03,
     9     0.8141392150152313739894469337646236D+06,
     *     0.4443333976920336450199566278735086D+05,
     1     -.7581357689658829552320208379094800D+07,
     2     -.1724414408156677624091002427428379D+07,
     3     0.3885169412811378737793205802028223D+08,
     4     0.4381068238150128071388945206576152D+08,
     5     0.5473527206680509066937988523244245D+09,
     6     -.7065477384326787137279790753035542D+09,
     7     -.2256229918537298972040227435406994D+11,
     8     0.4013988014760387308832470275847647D+10,
     9     0.4284518033035789284075064577628708D+12,
     *     0.1429655401532567726414099153910284D+12,
     1     -.5064509002404706205791265492180252D+13,
     2     -.5222511541126154415473296676761854D+13,
     3     0.2724764383781371701180520770734855D+14,
     4     0.9610621597492042820630798321962236D+14,
     5     0.2762593884281786942659248292070664D+15,
     6     -.1154149399043018500740538391217895D+16,
     7     -.8407589896849023997185090793956249D+16,
     8     0.8853869030946024698515939221044003D+16,
     9     0.1038722300501320735851225508399509D+18,
     *     -.2961697917978554547036905172579673D+17,
     1     -.7832712836315209305657210709147626D+18,
     2     -.2092549893683802671448348976058586D+18,
     3     0.3517993411698115730362597874143731D+19,
     4     0.3642545511986960563625625433899780D+19,
     5     -.5709523702225282923629072438147718D+19,
     6     -.2496350606685831773044721808446659D+20,
     7     -.3157202132364708445983717969132545D+20,
     8     0.9562509340030459933373186982473790D+20,
     9     0.2194474763477600362588431230738271D+21,
     *     -.1878574704578632262638910137323215D+21,
     1     -.5304447245144251378068460158239391D+21,
     2     0.8783305024778512561968226928514932D+20,
     3     0.4526228923152977431623481249440294D+21,
     4     0.1806665447461778970975539463723705D+21/


c  rsmall=0.79999E+02, rlarge=0.16000E+03, iback=  1, m=  32 relerr=0.3206E-33
        data c0p5/
     1     0.9999999999999999999999917238720692D+00,
     2     0.5718529790384407067905042364172781D-24,
     3     -.8333333333333333332452433047918607D-01,
     4     0.4470911957143587686792332920718911D-20,
     5     0.8680555555555555250077478092332455D-01,
     6     -.4840624985652242755165031679259981D-17,
     7     -.1181520061728394519976016014362639D+00,
     8     0.2148397490095416341845449232255660D-14,
     9     0.1796895093881479362132063106815870D+00,
     *     -.5120736589279372164512662872821243D-12,
     1     -.2432372378158573827304800534443989D+00,
     2     0.6206303348140625182942703676383612D-10,
     3     0.1165169168930134960177022716103622D-01,
     4     0.3142883029751780507871333125596492D-09,
     5     0.2376799481824399716366207430071030D+01,
     6     -.1578588296380971745372952241422439D-05,
     7     -.1682605649883557809967669628512501D+02,
     8     0.3191598722293802069842508549190923D-03,
     9     0.9024646194228418910495999702489069D+02,
     *     -.3686383013670383963921350240721598D-01,
     1     -.4098106817865849393286214306007099D+03,
     2     0.2722791593630693306823032912843019D+01,
     3     0.1596924938552657481984858706804926D+04,
     4     -.1097376406394343490399984460884880D+03,
     5     -.1712314627184268256080055027148957D+05,
     6     -.1443805309622339035420873531197795D+04,
     7     0.7720724275823982926912168245335702D+06,
     8     0.5916713227009370377899236112260694D+06,
     9     -.2110909674749549831615720783809912D+08,
     *     -.4918166713305321839882581254761046D+08,
     1     -.2947959001030174960417064383229984D+09,
     2     0.2498553869126543262905151630622321D+10,
     3     0.6288655796213987284074978524732811D+11,
     4     -.8308745697037313234290330214157303D+11,
     5     -.3536819269950216258893102243779507D+13,
     6     0.1457005677728222173890931575256105D+13,
     7     0.1231388215772277169768727052572991D+15,
     8     0.1752555165455040511622125426725084D+14,
     9     -.2794894705875312246053289116408531D+16,
     *     -.2228814008116489921895736219882327D+16,
     1     0.3241001564222926132510474461087685D+17,
     2     0.8452214222517746332003490117495896D+17,
     3     0.3301050292345151575618322548449318D+18,
     4     -.1983382688548589392588386822331536D+19,
     5     -.2495506935247671289098008229702719D+20,
     6     0.2989121100860417550370579942716305D+20,
     7     0.6138922499123812804416582103849560D+21,
     8     -.2204805770349301768289956982538382D+21,
     9     -.9192901472852038852846699087722204D+22,
     *     -.1722070061797248502046966769941185D+22,
     1     0.8548877610881355012913381705937654D+23,
     2     0.7419591810093618053985289563520107D+23,
     3     -.3641951804573729163914601654891302D+24,
     4     -.1074630641091420407487378413015144D+25,
     5     -.1841329755323540616897871449280740D+25,
     6     0.8985733568224618080267547394554486D+25,
     7     0.3836357531270873433240413585040152D+26,
     8     -.4281502315903731921618720348723443D+26,
     9     -.2495782942448508071198558975225814D+27,
     *     0.8051331029147300377304074565410705D+26,
     1     0.7569796265765398862966686213019625D+27,
     2     0.1658471359953787558732382532864767D+27,
     3     -.8202893449791027573386012534356133D+27,
     4     -.7535786561785784918143010329135938D+27/

c  rsmall=0.16000E+03, rlarge=0.32000E+03, iback=  1, m=  30 relerr=0.4447E-33
        data c0p6/
     1     0.1000000000000000000000000629642797D+01,
     2     0.1394916114021106951199170597248174D-23,
     3     -.8333333333333333333307591719018498D-01,
     4     -.2696231069920570398142092130748311D-20,
     5     0.8680555555555555421425792390730384D-01,
     6     0.1902872478807536875990468534600820D-17,
     7     -.1181520061728383344548215817152137D+00,
     8     -.5492389235675215525427655878300685D-15,
     9     0.1796895093873392424286566202492627D+00,
     *     -.4166751574808564426395470055086287D-13,
     1     -.2432372375729938397699237787550707D+00,
     2     0.9184822680861611121552217276056535D-10,
     3     0.1165165236279020745640446836512610D-01,
     4     -.3683158768255075076055079908549420D-07,
     5     0.2376801523286930384447441632801599D+01,
     6     0.8495189193651960585765208160264332D-05,
     7     -.1682541043854510101980316440938587D+02,
     8     -.1243889156339375008422570546475499D-02,
     9     0.9004755299965792084114851213333493D+02,
     *     0.1011182330575892288785772766620907D+00,
     1     -.3796012203750104027519878765007213D+03,
     2     0.1220253700549919526714460884581350D+01,
     3     -.1314431067962986518220835262034437D+04,
     4     -.1682866645340028393707098019973772D+04,
     5     0.1459557976820054758999531736339516D+06,
     6     0.2713893266815815689683646005519864D+06,
     7     0.5563124202793993996780856952199481D+06,
     8     -.2626530381831072714927721020446038D+08,
     9     -.1011801476888134115436426862712465D+10,
     *     0.1686846779129930207691042205807628D+10,
     1     0.1128966127827337706735370083740201D+12,
     2     -.6358073057505498939303695259387995D+11,
     3     -.7505222898710865605239807762475336D+13,
     4     -.3425016535682962144334063260798801D+11,
     5     0.3309846497352039967683881118680511D+15,
     6     0.1904689600345792471313828601621973D+15,
     7     -.8618657548825768243062963413458385D+16,
     8     -.1468324035199649384242390821164209D+17,
     9     0.8419920203742813108503608514063804D+16,
     *     0.6625459902599348930143668465006825D+18,
     1     0.1084291785789063718888046649638924D+20,
     2     -.1958395317234001563698327380888263D+20,
     3     -.5566996454136790983628760191648955D+21,
     4     0.3386176482106489561528610030045782D+21,
     5     0.1617122822204147466997111904855186D+23,
     6     -.4439538408470661339192151759622079D+21,
     7     -.2978554459866640178505882964989228D+24,
     8     -.1596234759447669253903389646353676D+24,
     9     0.3091691801893080278841746180270683D+25,
     *     0.4942176373397726852192249771591490D+25,
     1     -.3132307193933747170254200752947422D+25,
     2     -.8082584508319775032013147764436203D+26,
     3     -.4024159659353040139846810126715687D+27,
     4     0.7691518928106380160213911942286443D+27,
     5     0.5705236937080251706090741836254880D+28,
     6     -.3636592853416664224632910787678524D+28,
     7     -.3405586362831385762378678897911631D+29,
     8     0.1554776605219039703379110515939707D+28,
     9     0.7410427516582548729522798581913610D+29,
     *     0.3828201025375238491005038475457560D+29/
        
c     
c        if z is not in the right upper quadrant - bomb out
c
        ier=0
        com=z
        if( (rea(1) .ge. 0) .and. (rea(2) .ge. 0) ) goto 1400
        ier=4
        return
 1400 continue
c

        done=1
        thresh0=1**2
        thresh1=5**2
        thresh2=10**2
        thresh3=20**2
        thresh4=40**2
        thresh5=80**2
        thresh6=160**2
        thresh7=320**2

c
c       check if if the user-specified z is in one of the 
c       intermediate regimes 
c
        d=z*dconjg(z)
        if( (d .le. thresh0) .or. (d .gt. thresh7) ) goto 3400
c
c        the user-specified z is in one of the intermediate regimes.
c        act accordingly
c
c
        if(d .gt. thresh1) goto 1900
c
c       z is in the first intermediate regime: its absolute value is 
c       between 1 and 5. act accordingly
c
c       . . . evaluate the expansion
c
        nu=3*(z/2)**toth
c 
        cd=done/nu
c
        m=63
        call abram0p(c0p0,m,cd,j0)
        j0=dc*j0*(nu**26)
        if (ifexpon .eq. 1) j0=j0*exp(-nu)
        return
 1900 continue
c
        if(d .gt. thresh2) goto 2000
c
c       z is in the first intermediate regime: its absolute value is 
c       between 5 and 10. act accordingly
c
c       . . . evaluate the expansion
c
        nu=3*(z/2)**toth
c 
        cd=done/nu
c
        m=48
        call abram0p(c0p1,m,cd,j0)
        j0=dc*j0*nu
        if (ifexpon .eq. 1) j0=j0*exp(-nu)

        return
 2000 continue
c
        if(d .gt. thresh3) goto 3000
c       z is in the second intermediate regime: its absolute value is
c       between 10 and 20. act accordingly.
c
        nu=3*(z/2)**toth
c 
        cd=done/nu
c
        m=38
        call abram0p(c0p2,m,cd,j0)
        j0=dc*j0
        if (ifexpon .eq. 1) j0=j0*exp(-nu)

        return

        return
 3000 continue
c
        if(d .gt. thresh4) goto 3100
c       z is in the third intermediate regime: its absolute value is
c       between 20 and 40. act accordingly.
c
        nu=3*(z/2)**toth
c 
        cd=done/nu
c
        m=34
        call abram0p(c0p3,m,cd,j0)
        j0=dc*j0
        if (ifexpon .eq. 1) j0=j0*exp(-nu)

        return
 3100 continue
c
        if(d .gt. thresh5) goto 3200
c       z is in the fourth intermediate regime: its absolute value is
c       between 40 and 80. act accordingly.
c
        nu=3*(z/2)**toth
c 
        cd=done/nu
c
        m=32
        call abram0p(c0p4,m,cd,j0)
        j0=dc*j0
        if (ifexpon .eq. 1) j0=j0*exp(-nu)

        return
 3200 continue
        
        if(d .gt. thresh6) goto 3300
c       z is in the fourth intermediate regime: its absolute value is
c       between 80 and 160. act accordingly.
c
        nu=3*(z/2)**toth
c 
        cd=done/nu
c
        m=32
        call abram0p(c0p5,m,cd,j0)
        j0=dc*j0
        if (ifexpon .eq. 1) j0=j0*exp(-nu)

        return
 3300 continue
        if(d .gt. thresh7) goto 3400
c       z is in the fourth intermediate regime: its absolute value is
c       between 160 and 320. act accordingly.
c
        nu=3*(z/2)**toth
c 
        cd=done/nu
c
        m=30
        call abram0p(c0p6,m,cd,j0)
        j0=dc*j0
        if (ifexpon .eq. 1) j0=j0*exp(-nu)

        return
 3400 continue
c
c        z is either in the local regime or the asymptotic one.
c        if it is in the local regime - act accordingly.
c
        if(d .ge. 102400.d0) goto 4000
        call abram0series(z,j0,ifexpon)
        return
c
c        z is in the asymptotic regime. act accordingly.
c
 4000 continue
        call abram0asym(z,j0,ifexpon)
        return
        end
c
c
c
c
c
