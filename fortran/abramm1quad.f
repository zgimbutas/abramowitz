c
c
c
c
ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
c
c
c        this is the end of the debugging code and the beginning of the
c        Abramowitz function code proper.
c
c
ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
c
c
        subroutine abramm1(z,jm1,ifexpon)
        implicit real *8 (a-h,o-z)
        complex *16 z,jm1,jm1u,com,zu,ima
        real *8 rea(2)
        equivalence (rea(1),com)
        data ima/(0.0d0,1.0d0)/,
     $     pi/3.141592653589793238462643383279502884197d0/
c
c        this subroutine evaluates the Abramowitz function J_{-1}
c        for a user-specified complex number z with Re(z)>=0.
c        
c        The code is reasonably accurate (32-digit relative accuracy
c        when ifexpon=0) 
c        and reasonably fast (O(1) cost for any z).
c
c
c        When ifexpon=1, that is, the Abramowitz function is evaluated
c        honestly. The subroutine will lose accuracy gradually
c        simply due to the ill-conditioning of evaluating the 
c        exponential factor exp(-nu) with nu=3(z/2)**(2/3).
c        The condition number of evaluating exp(-nu) is abs(nu). 
c        Thus, the subroutine will lose an extra log_{10}abs(nu) 
c        digits if the function is evaluated honestly.
c        
c        
c                      input parameters:
c
c  z - the complex number for which the Abramowitz function
c        J_{-1} is to be evaluated
c
c  ifexpon - the integer parameter telling the subroutine whether
c        to calculate the actual values of the Abramowitz function,
c        or the values of the Abramowitz function scaled by e^{nu}.
c        Permitted values: 0 and 1. 
c    ifexpon = 1 will cause the subroutine to evaluate the Abramowitz 
c        function honestly
c    ifexpon = 0 will cause the subroutine to scale the Abramowitz 
c        function by e^{nu}, where nu=3(z/2)^(2/3).
c                
c
c                      output parameters:
c
c  jm1 - the said Abramowitz function
c        
c       
c        . . . if z in the upper half-plane - act accordingly
c
        com=z 
        if(rea(2) .lt. 0) goto 1400
        call abramm1ur(z,ier,jm1,ifexpon)
        return
 1400 continue
c
c       z is in the right lower quadrant. compute 
c       jm1 at the points zu obtained from z by reflection
c       in the x axis.
c
        zu=dconjg(z)
c
        call abramm1ur(zu,ier,jm1u,ifexpon)
        jm1=dconjg(jm1u)

        return
        end
c
c
c
c
c
        subroutine abramm1p(p,m,z,f)
        implicit real *8 (a-h,o-z)
        complex *16 p(1),z,f
c
c       evaluate a polynomial at a point
c
        f=p(m)
        do 1200 i=m-1,1,-1
        f=f*z+p(i)
 1200 continue
        return
        end
c
c
c
c
c
        subroutine abramm1pr(p,m,z,f)
        implicit real *8 (a-h,o-z)
        real *8 p(1),z,f
c
c       evaluate a polynomial at a point
c
        f=p(m)
        do 1200 i=m-1,1,-1
        f=f*z+p(i)
 1200 continue
        return
        end
c
c
c
c
c
        subroutine abramm1pc(p,m,z,f)
        implicit real *8 (a-h,o-z)
        real *8 p(1)
        complex *16 z,f
c
c       evaluate a polynomial at a point
c
        f=p(m)
        do 1200 i=m-1,1,-1
        f=f*z+p(i)
 1200 continue
        return
        end
c
c
c
c
c
        subroutine abramm1asym(z,jm1,ifexpon)
c
c        evaluate the asymptotic expansion for J_{-1} at
c        the user-supplied point z.
c
        implicit real *8 (a-h,o-z)
        dimension c(51),d(51)
        complex *16 z,jm1,nu,pp,cd
        data ima/(0.0d0,1.0d0)/,
     $     dc/1.0233267079464884884795516248892648607073764377510d0/,
     1     toth/0.66666666666666666666666666666666666666666666666667d0/
c
        data c/
     1     +1.0000000000000000000000000000000000000000000000000D0,
     2     -8.3333333333333333333333333333333333333333333333333D-2,
     3     +3.4722222222222222222222222222222222222222222222222D-3,
     4     +5.5459104938271604938271604938271604938271604938272D-2,
     5     -1.7476650913065843621399176954732510288065843621399D-1,
     6     +4.7552079984353566529492455418381344307270233196159D-1,
     7     -1.2045345181391163218259411675049535131839658588630D0,
     8     +2.4467120737235599287773713356703754508967128994564D0,
     9     -1.8860996970698505165102552541109925654964520991041D-1,
     *     -4.4365225236052470241629998844925087325466671433580D1,
     1     +4.0419909410521589275394577099835080208548288730284D2,
     2     -2.7103991962168623863518911975426052104961722868508D3,
     3     +1.4978896666659197068846295333206644541667066910083D4,
     4     -6.0359347335059701788507406369202238422822048114820D4,
     5     +4.8799291299849646159738020901711381802341646884323D3,
     6     +3.5984842320676985736692140754328057655621598164223D6,
     7     -5.4338007286250610805278902251287792947592777870626D7,
     8     +5.8149586710940319941765522303974949108775203346423D8,
     9     -4.9569476901284883261850490384039655713268499402505D9,
     *     +2.9885762986868794353261846431570654672058291341440D10,
     1     -2.4489051141273361428359954287215775680363143510369D9,
     2     -3.7390326384256359481805570790262413030148524725927D12,
     3     +7.8876899200760638173846779492975338662266954310062D13,
     4     -1.1594549559126533900778874672503270572559224000835D15,
     5     +1.3361013131126255882003649261023664219910805281543D16,
     6     -1.0727251872321295046418980983244031436873131429260D17,
     7     +8.8407462695403105166182619686013775587213214453163D15,
     8     +2.3021431743994440605389348512399133800125515048301D19,
     9     -6.2371664460968286939122207914688028725085520061772D20,
     *     +1.1662539086147836954338156790333719501849348052895D22,
     1     -1.6937474791212160100189521942618873255685607393352D23,
     2     +1.6985895325857256860284078134784689217822732350432D24,
     3     -1.4041250531489848351699857277611393439582403066980D23,
     4     -5.5731493315561839570033294765953972746888516051913D26,
     5     +1.8442195665021781532505392120624978424128673549990D28,
     6     -4.1859633468912161386964689000742079188978022612486D29,
     7     +7.3348995570188302217074917497582661856097422857868D30,
     8     -8.8227560499403389729435420352188696252399981986876D31,
     9     +7.3065750241364854134941958178321332201773326933178D30,
     *     +4.1079003520838357326529703134917202459507248261582D34,
     1     -1.6057767755132064508138059497269625332477759394305D36,
     2     +4.2869829713332878958123512050224798646968097706319D37,
     3     -8.7978962542074156283823091547467106042216687634871D38,
     4     +1.2342014545062544876482412842985667565376364402821D40,
     5     -1.0233301598320806709461658533932802342111813916712D39,
     6     -7.7396972522097370904295192213752880915924531784730D42,
     7     +3.4897588072311495465418416240130620911062811725617D44,
     8     -1.0712473186029117650262422350900847239558196060244D46,
     9     +2.5198047175590917099125120992484646179142978785389D47,
     *     -4.0388186405081799291509620340164357373290518867940D48,
     1     +3.3515652002254767355550508828868193905551804627724D47/


c
        m=32
        nu=3*((z/2)**toth)

cccc        do i=1,51
cccc           d(i)=c(i)/abs(nu)**i
cccc        enddo
cccc        call prin2('d=*',d,51)
        
        pp=c(m+1)
        cd=1/nu
c
        do 1800 i=m,1,-1
        pp=pp*cd+c(i)
 1800 continue
c 
        jm1=dc*sqrt(3/nu)*pp
        if (ifexpon .eq. 1) jm1=jm1*exp(-nu)      
c     
        return
        end
c
c
c
c
c
        subroutine abramm1series(z,jm1,ifexpon)
        implicit real *8 (a-h,o-z)
        dimension a(25),b(50)
        complex *16 z,jm1,lnz,z2,c1,c2,nu
c
c
c        this subroutine evaluates the Abramowitz function J_{-1}
c        for a user-specified complex number z in the local regime,
c        i. e. for cdabs(z) < 1, using the series expansion 
c
c                      input parameters:
c
c  z - the complex number for which the Abramowitz function
c        J_{-1} is to be evaluated
c
c                      output parameters:
c
c  jm1 - the said Abramowitz function
c        
        data a/
     1     -2.0000000000000000000000000000000000000000000000000D0,
     3     +1.0000000000000000000000000000000000000000000000000D0,
     5     -4.1666666666666666666666666666666666666666666666667D-2,
     7     +4.6296296296296296296296296296296296296296296296296D-4,
     9     -2.0667989417989417989417989417989417989417989417989D-6,
     1     +4.5928865373309817754262198706643151087595532039976D-9,
     3     -5.7990991632966941608916917558892867534842843484819D-12,
     5     +4.5518831737022717118459118963024228834256549046169D-15,
     7     -2.3707724863032665165864124459908452517841952628213D-18,
     9     +8.6084694491767121154190720624213698321866204169255D-22,
     1     -2.2653866971517663461629137006372025874175316886646D-25,
     3     +4.4576676449267342506157294384832793927932540115400D-29,
     5     -6.7295707199980891464609442006088155084439221188707D-33,
     7     +7.9639890177492179248058511249808467555549374187819D-37,
     9     -7.5245550054319897248732531415162951205167587101114D-41,
     1     +5.7659425328980764175273970433075058394764434560241D-45,
     3     -3.6327762934085662912849023710354749492669124596926D-49,
     5     +1.9045697249704132805310382568079453440636009540173D-53,
     7     -8.3975737432557904785319147125570782366119971517517D-58,
     9     +3.1435104227205923779785560801666086084495010675121D-62,
     1     -1.0075353918976257621726141282585284001440708549718D-66,
     3     +2.7861716495150316967330737466360499976330702255733D-71,
     5     -6.6936662730997301958799580689891648991761248932666D-76,
     7     +1.4059370453895673589329884622955607853762077070503D-80,
     9     -2.5966626872591004708425466576085268642438824376668D-85/




        data b/
     1     -1.7316469947045985818195362702472072931264780078198D0,
     2     +3.5449077018110320545963349666822903655950989122448D0,
     3     -1.1341765026477007090902318648763963534367609960901D0,
     4     -3.9387863353455911717737055185358781839945543469386D-1,
     5     +8.1979576499209751767648549925405403615420597059310D-2,
     6     +7.8775726706911823435474110370717563679891086938773D-3,
     7     -1.1577977635714663776652308016403069537515868809059D-3,
     8     -5.3588929732593077166989190728379295020334072747464D-5,
     9     +5.9806967430793448927326299487438117502610053026081D-6,
     *     +1.6539793127343542335490490965549165129732738502304D-7,
     1     -1.4719335240679294091760668290304035256638539447040D-8,
     2     -2.7338501036931474934695026389337463024351633888106D-10,
     3     +2.0078726603525024874472946222860416356501683654204D-11,
     4     +2.6961046387506385537174582238005387597979915077027D-13,
     5     -1.6760795833721868880525746902531471557190633459574D-14,
     6     -1.7118124690480244785507671262225642919352327033033D-16,
     7     +9.1839792232715994576195555638833867759620923522355D-18,
     8     +7.4040331706229432463268474317584960723842244952565D-20,
     9     -3.4810659380875343444521307684839168061395883034668D-21,
     *     -2.2788652418045377797250992403073241220019158187924D-23,
     1     +9.5064693855850968224462625345286172531836977405509D-25,
     2     +5.1674948793753691150229007716719367845848431265134D-27,
     3     -1.9323670184549269802616312253045730268469781233694D-28,
     4     -8.8803830200642191356296627799827062804345130203014D-31,
     5     +3.0025594995514959678319794030641411188374200923429D-32,
     6     +1.1840510693418958847506217039976941707246017360402D-34,
     7     -3.6464422615939150780225576475490554849494708568526D-36,
     8     -1.2493943962666412205873395631504634069057737005806D-38,
     9     +3.5268557757523377929555013167173682472911973231715D-40,
     *     +1.0611469307513514698380665560985760208134650081370D-42,
     1     -2.7608936530165459016604313852023197887910240435180D-44,
     2     -7.3614077748966456457722272362024004218762747702882D-47,
     3     +1.7738978127957476932216206633459509400378014156450D-48,
     4     +4.2248667211298471337076602595284667251356030591645D-51,
     5     -9.4698306496814759305371097499826256206715037845408D-53,
     6     -2.0287475251523875792113614691613285594888850224079D-55,
     7     +4.2460565946661359845094791369921581452495858422382D-57,
     8     +8.2328850140101760377053870187538696513630590958847D-60,
     9     -1.6144907151537134799404292918986687042140417851894D-61,
     *     -2.8488477158414395092236364644983804461618253558548D-64,
     1     +5.2508607384695431023323813632229806873635956966881D-66,
     2     +8.4736695890584161487913041775680560564004323493598D-69,
     3     -1.4721012798581147413625658435886796718383830665787D-70,
     4     -2.1823043573253022608852414889819609200341065567900D-73,
     5     +3.5826570377647029831894640680040089454401950407781D-75,
     6     +4.8985507459602744352081739371087787206152784664197D-78,
     7     -7.6173802741955233148012769315366815517890418354435D-80,
     8     -9.6414878775764647296793235914515297510486320121631D-83,
     9     +1.4232185539630085436701372121801086265001613011449D-84,
     *     +1.6731722680786590187559564749846469788714133021247D-87/
c
c        evaluate jm1
c
        m=29
        c1=b(m)
        do k=m-1,1,-1
           c1=c1*z+b(k)
        enddo

        m2=15
        c2=a(m2)
        z2=z**2
        do k=m2-1,1,-1
           c2=c2*z2+a(k)
        enddo

        jm1=(c1+c2*log(z))/2
        if (ifexpon .eq. 1) return

        nu=3*(z/2)**(2.0d0/3)
        jm1=jm1*exp(nu)        
        
        
c
        return
        end
c
c
c
c
c
        subroutine abramm1ur(z,ier,jm1,ifexpon)
        implicit real *8 (a-h,o-z)
        complex *16 z,com,ima,cd,jm1,nu
        dimension rea(2)
        equivalence (rea(1),com)
        real *8 cm1p0(126)
        real *8 cm1p1(96)
        real *8 cm1p2(76)
        real *8 cm1p3(68)
        real *8 cm1p4(64)
        real *8 cm1p5(64)
        real *8 cm1p6(60)
        data ima/(0.0d0,1.0d0)/,
     $     dc/1.0233267079464884884795516248892648607073764377510d0/,
     1     toth/0.66666666666666666666666666666666666666666666666667d0/
        
c
c        this subroutine evaluates the Abramowitz function J_{-1}
c        for a user-specified complex number z in the upper right quadrant.
c        it is reasonably accurate (32-digit relative accuracy) 
c        and reasonably fast.
c        
c
c                      input parameters:
c
c  z - the complex number for which the Abramowitz function
c        J_{-1} is to be evaluated
c
c                      output parameters:
c
c  ier - error return code. 
c         ier=0 means successful conclusion
c         ier=4 means that z is not in the upper right quadrant
c  jm1 - the said Abramowitz function
c        

c  rsmall=0.99902E+00, rlarge=0.50010E+01, iback= 27, m=  63 relerr=0.4858E-33
        data cm1p0/
     1     -.3354129975249634323113994590035064D-34,
     2     0.1838906363626567921034812632048304D-34,
     3     0.7743518258038727222091871921119910D-32,
     4     0.1065088659132375641221355551776173D-33,
     5     -.6671224658844082498054669385836498D-30,
     6     -.3897515215110850668015401611403821D-30,
     7     0.2548221643028646520505471529425420D-28,
     8     0.4375434408497320345817440249474101D-28,
     9     -.3196371097726866560476262793630357D-28,
     *     -.2451193196627168911210176957644243D-26,
     1     -.4489849453409954283015978960582409D-25,
     2     0.8201126420560981453453679633834140D-25,
     3     0.2484198398188582235577094391277691D-23,
     4     -.1545084223055945607250943962512681D-23,
     5     -.7714732252377520427124295438344488D-22,
     6     0.3353222938306209972658678795437506D-23,
     7     0.1565346740122597806184529945479390D-20,
     8     0.7930974168012415590625852742719730D-21,
     9     -.1940104830810173308665705192048088D-19,
     *     -.2897029468730667503202287117222103D-19,
     1     0.4844217334283011169348792537505459D-19,
     2     0.6112190880449027760329278287155174D-18,
     3     0.4026511833514187470157665307642212D-17,
     4     -.8754967494040663586769545352156234D-17,
     5     -.1102164183477465458281550236884841D-15,
     6     0.8045185377994381860434674584762089D-16,
     7     0.1739512905366234876660922649531600D-14,
     8     -.2140944404925071573545504910533703D-15,
     9     -.1903696759900627441212100041377753D-13,
     *     -.7699581643285463291378465391771375D-14,
     1     0.1388819498167113550215894518297811D-12,
     2     0.1713444911977345847256968708360822D-12,
     3     -.3851720687065827768647176930674094D-12,
     4     -.2146601455430288676537874746302088D-11,
     5     -.6344115654964462202823171528625151D-11,
     6     0.1888931887039503631471142181904985D-10,
     7     0.1237735777551276365740865993445925D-09,
     8     -.1147550570381214926987489972589271D-09,
     9     -.1287603424658831086896895665364062D-08,
     *     0.3305488793904981061951383847037222D-09,
     1     0.9477332647114242232644296291168094D-08,
     2     0.2335420452459421280276919795769291D-08,
     3     -.4989102765191392414790109513935561D-07,
     4     -.4468194634742732785504615552282827D-07,
     5     0.1502751665614658397133505806879901D-06,
     6     0.4032847509082788565309458515038864D-06,
     7     0.3128874874479858818395131191996976D-06,
     8     -.2576062267007288516210802329060163D-05,
     9     -.8192086674808644040137958927687403D-05,
     *     0.1221424984564123232472606639104017D-04,
     1     0.6810378923306923210686098788662480D-04,
     2     -.3895653512930240351933190614956578D-04,
     3     0.9996065933371255574257752402030162D+00,
     4     0.2800825385840211265859759850143247D-04,
     5     -.8158563718432450078022022299339359D-01,
     6     0.6627474962686284361213351380763474D-03,
     7     -.2479478616799104166368855483006671D-02,
     8     -.5853105504208148222065239987860383D-02,
     9     0.6921571776115349415112065791705838D-01,
     *     0.3224760865968790920631517997453958D-01,
     1     -.1807489541463282102919726220960129D+00,
     2     -.1376423528671178692989185615349292D+00,
     3     0.3388397813539900454157835393552920D+00,
     4     0.4818118709900364711023229461486137D+00,
     5     -.3588502370580916842717704386959433D+00,
     6     -.1405145162605613365299974501232072D+01,
     7     -.5147876468508942563091816209012130D+00,
     8     0.3388764209369270541486589592582640D+01,
     9     0.4243789036434904114735609200377682D+01,
     *     -.6503843826593411625581984705287255D+01,
     1     -.1436250160003119986370126146403502D+02,
     2     0.8731301109763319746918720211650835D+01,
     3     0.3450262394127098196926829712925787D+02,
     4     -.2968377340123443888872351725081900D+01,
     5     -.6274671287556952475746823417919165D+02,
     6     -.2542820223319445598591521484475692D+02,
     7     0.8135073688622697632372768161158272D+02,
     8     0.9522926472782358037835768072655986D+02,
     9     -.4814365052466277648756133424082788D+02,
     *     -.2133075816675822317468757124584634D+03,
     1     -.9514066774820271445949907522487102D+02,
     2     0.3466435740103569341436434696922468D+03,
     3     0.3830196091918708862015094317342805D+03,
     4     -.4016940605037136592358436004232125D+03,
     5     -.7642526540663620594140072632366645D+03,
     6     0.2467508279375036913450430740755530D+03,
     7     0.1067330492184744859389204919463248D+04,
     8     0.2021467124706906557262856272000424D+03,
     9     -.1057741196740817278173405699442511D+04,
     *     -.8708623374715855873965444263773242D+03,
     1     0.5939073807512566811814407389711110D+03,
     2     0.1493135210208298747225141913136272D+04,
     3     0.2202172399423124590023842585423017D+03,
     4     -.1733314332353566373677668080847731D+04,
     5     -.1037939012156703176058078596544766D+04,
     6     0.1415756017408016126246055894773234D+04,
     7     0.1475270801998807013158542159509934D+04,
     8     -.6780357848615130242211159339780755D+03,
     9     -.1372379232556360897368458929711916D+04,
     *     -.1066179776878383405501596005490739D+03,
     1     0.8864852902171172762483094994910863D+03,
     2     0.5893591314581991522943397006765637D+03,
     3     -.3408968221629598464429685323329743D+03,
     4     -.6643075661790474729327696407701049D+03,
     5     -.1721581000443508506671885248473534D+02,
     6     0.4715177698394354441161828372781498D+03,
     7     0.1387566431441360168499722709097895D+03,
     8     -.2274854193324807957867658954327779D+03,
     9     -.1161434538070836155364726670733415D+03,
     *     0.6516934959313790881741948404224935D+02,
     1     0.5819567789909550727574031758089787D+02,
     2     0.5281804691711655967071857331864988D-01,
     3     -.1906800186629685646217766917430958D+02,
     4     -.1075599865189839275594591578501460D+02,
     5     0.3596251891022565200828761529895486D+01,
     6     0.5943938481854922423503471782667108D+01,
     7     -.5540177834796912775978697360889527D-01,
     8     -.1807659907623108017373190169442919D+01,
     9     -.1723051954841744486518168990870080D+00,
     *     0.3284138086885901736842335660862960D+00,
     1     0.4719502113390673593199632534264516D-01,
     2     -.3048238351157475062998068952414432D-01,
     3     -.5580651516072163422846219941772050D-02,
     4     0.3298028135617454206624719272969010D-03,
     5     0.2461307783914229782867537542809824D-03,
     6     0.1206301575182109961136110904245384D-03/


c  rsmall=0.49990E+01, rlarge=0.10001E+02, iback=  1, m=  48 relerr=0.7048E-33
        data cm1p1/
     1     0.9999999999999999863786326034496449D+00,
     2     0.6328262899861104487235272083111656D-17,
     3     -.8333333333332895028960569497610211D-01,
     4     0.3176681184835390630865768318207343D-15,
     5     0.3472222221692229107344263416764083D-02,
     6     -.3454673763182979238773245707538220D-12,
     7     0.5545910496638070919263154136314254D-01,
     8     0.5269503172853620070998081085781194D-10,
     9     -.1747665090868197310939859242086916D+00,
     *     -.4157115862754120526801679301147930D-08,
     1     0.4755206891331788584894799424351836D+00,
     2     0.1987493243497228591251315388325017D-06,
     3     -.1204525929679297488164949422790763D+01,
     4     -.5483425039207183369925569526525641D-05,
     5     0.2446329251363765574281314373906729D+01,
     6     0.2982411809248669595191617780535909D-04,
     7     -.1772108004555281511314699213449854D+00,
     8     0.4930270812231176741778482605681410D-02,
     9     -.4458581830665201432253704320671750D+02,
     *     -.2717342941147925723424482397668018D+00,
     1     0.4059892496257133905735452412790931D+03,
     2     0.8507163017699027260081300821891597D+01,
     3     -.2661072157112262092621686021561842D+04,
     4     -.1855875689700455661492400263095847D+03,
     5     0.1247899338273889963434479261715055D+05,
     6     0.2859871174216055313533041684901622D+04,
     7     0.1825077675719969487731527283420136D+04,
     8     -.2659354615569048111017855666025447D+05,
     9     -.1082331523231744733268231008492574D+07,
     *     -.3493360426310453390172474302789046D+05,
     1     0.1782624126465724334159153933676834D+08,
     2     0.6943632199071818848019644478750919D+07,
     3     -.1904772095603816920162791783611747D+09,
     4     -.1578177662956990266314388227880412D+09,
     5     0.1375157241558341808745242317606764D+10,
     6     0.2342459655646948034378438919448035D+10,
     7     -.4028979839806068862391005194936160D+10,
     8     -.2620903571400934640480332648217368D+11,
     9     -.5864205593607589948551780823404261D+11,
     *     0.2271863180962121962721532923322111D+12,
     1     0.1195506584900247718478916956722495D+13,
     2     -.1477071989212020053816218465147413D+13,
     3     -.1279263393712788792451266825340383D+14,
     4     0.6078062251891383495095778972050081D+13,
     5     0.9743953560935678864852215564888939D+14,
     6     0.1873133497760674263776186662401121D+13,
     7     -.5456869943710752143803503944318687D+15,
     8     -.2949309712096045537683603206808043D+15,
     9     0.2025973918470338443151266553942026D+16,
     *     0.3042647352538531137264777946572755D+16,
     1     -.1784863472601211308181029607837528D+16,
     2     -.1987443163431559465870133653175392D+17,
     3     -.4087428270648167711100315447136745D+17,
     4     0.9224682789315386765454963115440007D+17,
     5     0.3790947153610731453812449384528308D+18,
     6     -.2818084865167276396320006362585560D+18,
     7     -.2031833808210863439436948922509707D+19,
     8     0.2405345256841261361961284955779150D+18,
     9     0.7512030678924153608969034242858961D+19,
     *     0.3263479357342804900299551686751083D+19,
     1     -.1776797236265116268869621255666858D+20,
     2     -.2448973076441025881498570949601075D+20,
     3     0.9178941963831638301526610656843783D+19,
     4     0.1025494706512195117916119842160970D+21,
     5     0.1411186065307986001493230855351043D+21,
     6     -.2894339688308183744678775388640505D+21,
     7     -.7769499442944207808360005382694801D+21,
     8     0.4982374179711814223568738643466303D+21,
     9     0.2416014511658624736668839849164898D+22,
     *     -.4789182773004116829298472339866171D+20,
     1     -.4955234007094315565969570748883499D+22,
     2     -.2926652958767117065702957490758268D+22,
     3     0.5746112804628678822065941291081601D+22,
     4     0.1099322748789018393512442154415827D+23,
     5     0.1821290966768325525349379760923353D+22,
     6     -.2398013275353331920669890711927322D+23,
     7     -.2467050026102257365435113767791504D+23,
     8     0.3352146090813793579044789985820284D+23,
     9     0.5922123865677766643695094457605062D+23,
     *     -.2345046142793000231540739628037298D+23,
     1     -.8375872025936403074777891866441591D+23,
     2     -.1544894673992245762102437478223500D+23,
     3     0.7226965391911859398986354092319906D+23,
     4     0.6618462771904005266749869294190309D+23,
     5     -.2545076337846126409110308332738525D+23,
     6     -.9159866176037807304560244588565567D+23,
     7     -.2134557492870057550899652978102655D+23,
     8     0.7254758248766872423739372244399397D+23,
     9     0.3532626975732691321254856402321273D+23,
     *     -.3154451827049500997008089181680167D+23,
     1     -.2156269113169643881539049758860362D+23,
     2     0.3808601746064128430449225446343519D+22,
     3     0.6176589754042446552630566370254146D+22,
     4     0.2448617883392605975253893195367071D+22,
     5     -.5951737416102272142862699930674999D+21,
     6     -.7943215201439018085818737222421844D+21/

c  rsmall=0.99990E+01, rlarge=0.20001E+02, iback=  1, m=  38 relerr=0.5421E-33
        data cm1p2/
     1     0.9999999999999999998855453874445355D+00,
     2     0.2535419698400330723409942310881147D-18,
     3     -.8333333333333324945664993955763289D-01,
     4     -.6265881254407213450398517179155453D-16,
     5     0.3472222222203112007796388494381475D-02,
     6     0.2657950142446054925740850061199851D-14,
     7     0.5545910494043991840250504891356896D-01,
     8     0.8240760708825167509840249481396414D-12,
     9     -.1747665092637390309201405837116347D+00,
     *     -.1552951929919465391628439844865126D-09,
     1     0.4755208028103832635943063211402692D+00,
     2     0.1377811489439114578052403150291693D-07,
     3     -.1204534298841502749836003122653862D+01,
     4     -.7590603058707399860099320311501321D-06,
     5     0.2446686271289213743563260639237001D+01,
     6     0.2655646071077714440222855636668028D-04,
     7     -.1872030918246144323618080748379609D+00,
     8     -.4572671584102282616496663804875241D-03,
     9     -.4441564948818040118491936289224064D+02,
     *     -.8466158942892997823183429978031283D-02,
     1     0.4054381599877404886121010128093592D+03,
     2     0.9246453058847477068452903111341273D+00,
     3     -.2728784584615867465365570552909162D+04,
     4     -.3692960079995852380824074470007757D+02,
     5     0.1498133737373788692744453036920001D+05,
     6     0.9778407311178795478310596804165183D+03,
     7     -.5141710202123920788482490950892586D+05,
     8     -.1866109187213589229906162079441450D+05,
     9     -.2984699510694692420314412488235851D+06,
     *     0.2487488624909452688366311086005184D+06,
     1     0.1004107227033985316067507741200327D+08,
     2     -.1746684685768177465827528423346570D+07,
     3     -.1553110645841488034246594609701276D+09,
     4     -.1408540601626869847878618190425541D+08,
     5     0.1792784591265446533648818961884433D+10,
     6     0.6906591547115501647425228833255760D+09,
     7     -.1594484434022035321299390148319823D+11,
     8     -.1293753829687487039450692054040363D+11,
     9     0.1004172232904863805420913041472296D+12,
     *     0.1673894258849539937620238361406789D+12,
     1     -.2692828706656362036897646228493997D+12,
     2     -.1645603313504075099499064813410324D+13,
     3     -.3053707856116123667753202699075550D+13,
     4     0.1248695629485160916793050292647370D+14,
     5     0.5498677714833191758673053781739526D+14,
     6     -.7067567954808576145191138165195403D+14,
     7     -.5015473201631244613044922354358388D+15,
     8     0.2564452446149024742499950368898352D+15,
     9     0.3192905077501800475009790221199510D+16,
     *     -.7353661846187948004228208658614214D+14,
     1     -.1474003976860983376471445364477767D+17,
     2     -.6884588283403492805843425547126687D+16,
     3     0.4576416494944566501964012414304148D+17,
     4     0.5832127457233647371888366690394799D+17,
     5     -.5668731446272034580211871240625465D+17,
     6     -.2951173216081641747923261519481740D+18,
     7     -.3094201346137029881294334369001729D+18,
     8     0.1030566886629041241497999381978584D+19,
     9     0.2367381784579508559766689959827556D+19,
     *     -.2402305934360184225641183217118289D+19,
     1     -.8735117696879013500889746603581417D+19,
     2     0.2722621813223286924781239457780301D+19,
     3     0.2077630967000309210769540700377126D+20,
     4     0.4038515862981354418417524306482777D+19,
     5     -.3159074789041029003535642739031003D+20,
     6     -.2602831180366738481158786844558787D+20,
     7     0.2399589554285493530822424967147961D+20,
     8     0.5975674554195760516842383628399977D+20,
     9     0.9493835255941868386848686867337197D+19,
     *     -.7860230235036973478930552975560283D+20,
     1     -.4171624146452328205360403013184884D+20,
     2     0.5791521822963101592344398137668637D+20,
     3     0.3795438855316651584651123132719559D+20,
     4     -.1790711037461925843857457389558348D+20,
     5     -.1205171872260746303224498066044724D+20,
     6     -.8014973228945478858087935400081825D+18/
        

c  rsmall=0.19999E+02, rlarge=0.40001E+02, iback=  1, m=  34 relerr=0.9850E-33
        data cm1p3/
     1     0.1000000000000000000000566186825852D+01,
     2     0.3039583510853224289460306586008837D-21,
     3     -.8333333333333333351725676108471192D-01,
     4     -.2837584258185577261137018855399471D-18,
     5     0.3472222222222228599888462457724621D-02,
     6     0.8665506226834534335720990735753158D-16,
     7     0.5545910493827761344503114472898010D-01,
     8     -.1322101927032696117450684637786647D-13,
     9     -.1747665091320751913834668250285173D+00,
     *     0.1068182421528206639226411672559422D-11,
     1     0.4755208000105005768176200795080363D+00,
     2     -.2522310305528845872699434036667033D-10,
     3     -.1204534530401767690815000538795771D+01,
     4     -.4389315326206571197334107637177272D-08,
     5     0.2446712635432126534654681896342787D+01,
     6     0.6198576494318621423996018042252106D-06,
     7     -.1886211957547235499624099076190346D+00,
     8     -.4420634250137846461245015604006654D-04,
     9     -.4436572385372697476292673513289833D+02,
     *     0.2082961003985619346634456015026832D-02,
     1     0.4042564480607871626578471510749910D+03,
     2     -.6618925053918144525009129162612466D-01,
     3     -.2713316098453532230246681962808975D+04,
     4     0.1175996224367609823344645067962170D+01,
     5     0.1507837919270553820148186689533311D+05,
     6     0.8349683901313548822963454654278162D+01,
     7     -.6277011050106719746083687962069061D+05,
     8     -.1453992742182603896914161238002179D+04,
     9     0.4361000398239581726800249207704662D+05,
     *     0.5925999886882919344005538675172030D+05,
     1     0.3373645239483239205592767863079383D+07,
     2     -.1575472455300175729091080369891278D+07,
     3     -.6319583740766178629729165453176843D+08,
     4     0.3077770786767185793436941841549180D+08,
     5     0.9457252362682110146536310096118172D+09,
     6     -.4476943258389357014620025223420802D+09,
     7     -.1307625252530708195077212298649822D+11,
     8     0.4542110943666504460247949793942998D+10,
     9     0.1618883439952215751032130853768751D+12,
     *     -.2202735360382217925227878624646263D+11,
     1     -.1698529295235745965785248415005857D+13,
     2     -.2289089366584620100151801983402946D+12,
     3     0.1432980245384553483488274728831653D+14,
     4     0.7006180622953168815293843716816992D+13,
     5     -.9028537375642864533872663368139667D+14,
     6     -.9555053695031990738201686440528814D+14,
     7     0.3451639133404685671777734031367951D+15,
     8     0.8917334907054427728661912640219069D+15,
     9     0.2475802424440549386004240380154808D+15,
     *     -.6100961643473190335581602943656858D+16,
     1     -.1531337304297255634409668225954238D+17,
     2     0.3032022365591094070716691748648114D+17,
     3     0.1284564982461300592240053517459658D+18,
     4     -.1001767641054805791120079699772614D+18,
     5     -.6493098947347997993707569091922669D+18,
     6     0.1388170354388816562687171765166325D+18,
     7     0.2186189306303013406879046760104999D+19,
     8     0.5580592641101689641260398660156112D+18,
     9     -.4686927156397242424714602523733693D+19,
     *     -.4091572406544608772822703939065413D+19,
     1     0.4955307737070495364540354371332363D+19,
     2     0.1242647496108386272776463131616284D+20,
     3     0.2082762971390824575182262443367923D+19,
     4     -.2094639875069294412351518166930196D+20,
     5     -.1184722090526491654196006823613707D+20,
     6     0.1801530670150722214017004330741515D+20,
     7     0.9455185115014124182396079776085651D+19,
     8     -.5203547854919310592244366120861980D+19/


c  rsmall=0.39999E+02, rlarge=0.80001E+02, iback=  1, m=  32 relerr=0.9695E-34
        data cm1p4/
     1     0.9999999999999999999999963883156842D+00,
     2     -.3333360488389399272171343375040478D-23,
     3     -.8333333333333333333233757186009163D-01,
     4     0.3407495545705385193436776677653908D-20,
     5     0.3472222222222222541433788921345186D-02,
     6     -.1204843691520980195125135606435877D-17,
     7     0.5545910493827140084899009574967428D-01,
     8     0.1964033417825972667397973323092567D-15,
     9     -.1747665091306127423808193660602589D+00,
     *     -.1012887792340987816897370174113121D-13,
     1     0.4755207998378741318592175649208706D+00,
     2     -.1955732639023735262293410547953533D-11,
     3     -.1204534517748648208917808159638396D+01,
     4     0.4784287558740057075037297184591472D-09,
     5     0.2446712067019259256347145908503425D+01,
     6     -.5224732356457002492680134482889888D-07,
     7     -.1886115587960343947061311572123836D+00,
     8     0.3439603800119424504283114367722311D-05,
     9     -.4436502946838952990004916520162798D+02,
     *     -.1265215444925307803892142317990036D-03,
     1     0.4041866970072086916300211343586768D+03,
     2     0.6628522135653159797605359095004710D-04,
     3     -.2709914478332669993022973556636720D+04,
     4     0.3089781135910166917289387693112853D+00,
     5     0.1496923484109405050871665654906834D+05,
     6     -.2129872956589150673174843623427888D+02,
     7     -.6048983644590131578055945146593601D+05,
     8     0.8290775238944344351374293198954023D+03,
     9     0.2290607113418512546520158873355314D+05,
     *     -.1965133392878926985190637445580951D+05,
     1     0.2867662915409861680379581856574578D+07,
     2     0.1780186870318558376238343741089556D+06,
     3     -.3663825319403365488384930567181503D+08,
     4     0.6513722203156222992146528240977220D+07,
     5     0.3350638401191676040042877770411207D+09,
     6     -.3403484307823080632506754552092527D+09,
     7     -.4641399354961385139684020424169245D+10,
     8     0.8289612570801243933229460395850725D+10,
     9     0.1046100379900474943927695769797436D+12,
     *     -.1233759767811933387147610826404331D+12,
     1     -.1966910271411601688803599985295299D+13,
     2     0.9554693846394846298418915792685011D+12,
     3     0.2435669864810223471061145057098737D+14,
     4     0.3111073012732807091745516802919067D+13,
     5     -.1582932755614529675400072020696719D+15,
     6     -.1869269286707558858694092065952656D+15,
     7     -.3747920546543044726319964215878924D+15,
     8     0.2364982391331203636772108318659763D+16,
     9     0.1989240980319734643642586234198225D+17,
     *     -.1262533066188423283310717882645681D+17,
     1     -.2084903076669199738638703327733847D+18,
     2     -.3991749357100242001272201271632155D+17,
     3     0.1040416093623459864982301103909209D+19,
     4     0.1214925900349627975337724452720472D+19,
     5     -.8136343172717264119822103657029078D+18,
     6     -.9541537812001659148188887214727272D+19,
     7     -.2125045662373777725190929913071653D+20,
     8     0.3811473613469406126479992014739886D+20,
     9     0.1259077218069884428259771614135725D+21,
     *     -.6653967390560761107264719634929168D+20,
     1     -.2961848063668558123564688374393971D+21,
     2     -.2335413796824534553793394116345584D+20,
     3     0.2399943539648467897621482326585101D+21,
     4     0.1772367668844931213154200258060473D+21/


c  rsmall=0.79999E+02, rlarge=0.16000E+03, iback=  1, m=  32 relerr=0.5916E-33
        data cm1p5/
     1     0.9999999999999999999999926794734023D+00,
     2     -.3286620558817264167534591341317377D-23,
     3     -.8333333333333333332771455164335832D-01,
     4     0.7942338442155579877326099830249287D-20,
     5     0.3472222222222221749111532511353376D-02,
     6     -.5714566021092029639718271552947970D-17,
     7     0.5545910493827065217865307857606834D-01,
     8     0.1969754883656278044109200725551410D-14,
     9     -.1747665091301527609604202465235844D+00,
     *     -.3364813971478668263724017641471052D-12,
     1     0.4755207997130647063974025162633293D+00,
     2     0.7046167488992607824816549624617127D-11,
     3     -.1204534498034583402495012695827443D+01,
     4     0.1044785549241441879437048895574603D-07,
     5     0.2446710350768894084816579540084570D+01,
     6     -.2758750946666919416453962876059875D-05,
     7     -.1886001378912094660715516079010938D+00,
     8     0.3938405267193214312300939656068204D-03,
     9     -.4434535059028624504053216355746685D+02,
     *     -.3566448103429601112377032598685929D-01,
     1     0.4010405558255281798778763739872106D+03,
     2     0.1846265958427647786188842425227290D+01,
     3     -.2424670949683085120367938371438434D+04,
     4     0.1291020137171846199984400190436701D+01,
     5     -.1822900306840756833354231860615822D+04,
     6     -.1002757373104591748249208302482516D+05,
     7     0.5044670786675203122044943045993878D+06,
     8     0.1036151802374350916184208256391488D+07,
     9     0.2182086032168747918225150330813982D+07,
     *     -.6284601517500420180588280854444828D+08,
     1     -.1593349011865101875272039776511249D+10,
     2     0.2500028031752951567852906969913245D+10,
     3     0.1106044643743306504137808336644268D+12,
     4     -.5599380006924051176474796177478982D+11,
     5     -.4584193737074370589317998152621106D+13,
     6     -.3011542941979860662447502227131398D+12,
     7     0.1243973012051507370901493206101220D+15,
     8     0.8506252513004351080333597612710381D+14,
     9     -.1847375154260306897143741260052111D+16,
     *     -.3957497408294383884816201774966917D+16,
     1     -.1087577512892480000854158718898921D+17,
     2     0.1109508538417986239350035577094242D+18,
     3     0.1474841461233265140910546171163586D+19,
     4     -.2012868980080835471677441073121766D+19,
     5     -.4477349783777658455628024793862313D+20,
     6     0.1912192119392315668254684503643935D+20,
     7     0.8143496266472128663008788989597556D+21,
     8     0.1076281146131376352084056436533863D+21,
     9     -.9320608972664890649366031484820033D+22,
     *     -.7333913467963434124387442780397707D+22,
     1     0.5206725647205007861201827682915964D+23,
     2     0.1347995758307949281501958957946705D+24,
     3     0.2426323845797158903217328247685291D+24,
     4     -.1437606718077243982048240280393915D+25,
     5     -.7670413262771179262727866747242960D+25,
     6     0.9045737270039636448498152513545158D+25,
     7     0.7072665588447094809788519217098700D+26,
     8     -.2430835075292726928959019005466481D+26,
     9     -.3359467076098751855588274114577605D+27,
     *     -.7011648177550448350111953945493873D+26,
     1     0.7511897868043462426597080044692687D+27,
     2     0.6899919845721663633877632313940734D+27,
     3     -.4219005136109534154702062703378558D+27,
     4     -.1412747696722968495807160593561552D+28/


c  rsmall=0.16000E+03, rlarge=0.32000E+03, iback=  1, m=  30 relerr=0.6158E-33
        data cm1p6/
     1     0.1000000000000000000000001771811346D+01,
     2     0.1841319155060154635204405440979962D-23,
     3     -.8333333333333333333439973295090831D-01,
     4     -.4409774491359885872494266339616838D-20,
     5     0.3472222222222221098137762396788091D-02,
     6     0.3748195734493722357193848539093581D-17,
     7     0.5545910493827320068406657571910396D-01,
     8     -.1489669860707375246784321455279636D-14,
     9     -.1747665091315213483139397799439961D+00,
     *     0.1955501563956611183933045559990052D-12,
     1     0.4755208001081840712212585497638992D+00,
     2     0.8335326202556475592601353075942690D-10,
     3     -.1204534565233761593353458514819707D+01,
     4     -.5179670351350911863110336099396053D-07,
     5     0.2446715119039141533586557945740116D+01,
     6     0.1426855949181562965004549238911386D-04,
     7     -.1878118754140864682020512587019029D+00,
     8     -.2431281162028150301597186343078709D-02,
     9     -.4465146962626353464819236215298366D+02,
     *     0.2542714598288900109656950413681476D+00,
     1     0.4525881006022342528019923820249619D+03,
     2     -.9765981196824186869677550076150825D+01,
     3     -.7941884004052552882201704446427194D+04,
     4     -.1779617208488956326170726724432360D+04,
     5     0.3694055139781475639767616126292627D+06,
     6     0.4074007557442299189117348907890034D+06,
     7     -.8755218542485369440553571788844809D+07,
     8     -.4541801513136912863272850228527207D+08,
     9     -.1152166551633041635531380990028477D+10,
     *     0.3282449265796886558765015554962298D+10,
     1     0.1750698185957230777902185363615526D+12,
     2     -.1494375703833200545913552923482006D+12,
     3     -.1317794226513448172827072101378776D+14,
     4     0.2398317770909365543362897387283280D+13,
     5     0.6440262998291876157301111647878042D+15,
     6     0.2325076548565921719808397385426894D+15,
     7     -.1971064695186329996029673470918938D+17,
     8     -.2350046425486993521938445071771434D+17,
     9     0.2047577923314595751188485861257346D+18,
     *     0.1181775924683872641193519542416433D+19,
     1     0.1414251295107506268450590907754464D+20,
     2     -.3818056339331282665594585340283892D+20,
     3     -.9186648350909888310034763359920979D+21,
     4     0.7579074941050261931574718118392518D+21,
     5     0.2931773113009446114619630035564863D+23,
     6     -.4839828067922443869000121904633939D+22,
     7     -.5832822578393697896312187973388685D+24,
     8     -.2212461951023550507358771290120254D+24,
     9     0.6819410779004075240636785240912770D+25,
     *     0.8396086615524578917913996255510531D+25,
     1     -.2345192082691768188563699937796437D+26,
     2     -.1490310985397355843015357997727028D+27,
     3     -.5884903920157027240876807169356492D+27,
     4     0.1517569954942200832137362914558717D+28,
     5     0.9958917075677299116256247144567200D+28,
     6     -.7969715762322504291213953397181517D+28,
     7     -.6391515136516574072809800113567836D+29,
     8     0.9593562487983473126200704674973017D+28,
     9     0.1478757459479754489126091439650561D+30,
     *     0.5852716897931637442269405536315971D+29/
        
c     
c        if z is not in the right upper quadrant - bomb out
c
        ier=0
        com=z
        if( (rea(1) .ge. 0) .and. (rea(2) .ge. 0) ) goto 1400
        ier=4
        return
 1400 continue
c

        done=1
        thresh0=1**2
        thresh1=5**2
        thresh2=10**2
        thresh3=20**2
        thresh4=40**2
        thresh5=80**2
        thresh6=160**2
        thresh7=320**2

c
c       check if if the user-specified z is in one of the 
c       intermediate regimes 
c
        d=z*dconjg(z)
        if( (d .le. thresh0) .or. (d .gt. thresh7) ) goto 3400
c
c        the user-specified z is in one of the intermediate regimes.
c        act accordingly
c
c
        if(d .gt. thresh1) goto 1900
c
c       z is in the first intermediate regime: its absolute value is 
c       between 1 and 5. act accordingly
c
c       . . . evaluate the expansion
c
        nu=3*(z/2)**toth
c 
        cd=done/nu
c
        m=63
        call abramm1p(cm1p0,m,cd,jm1)
        jm1=dc*sqrt(3/nu)*jm1*(nu**26)
        if (ifexpon .eq. 1) jm1=jm1*exp(-nu)
        
        return
 1900 continue
c
        if(d .gt. thresh2) goto 2000
c
c       z is in the first intermediate regime: its absolute value is 
c       between 5 and 10. act accordingly
c
c       . . . evaluate the expansion
c
        nu=3*(z/2)**toth
c 
        cd=done/nu
c
        m=48
        call abramm1p(cm1p1,m,cd,jm1)
        jm1=dc*sqrt(3/nu)*jm1
        if (ifexpon .eq. 1) jm1=jm1*exp(-nu)

        return
 2000 continue
c
        if(d .gt. thresh3) goto 3000
c       z is in the second intermediate regime: its absolute value is
c       between 10 and 20. act accordingly.
c
        nu=3*(z/2)**toth
c 
        cd=done/nu
c
        m=38
        call abramm1p(cm1p2,m,cd,jm1)
        jm1=dc*sqrt(3/nu)*jm1
        if (ifexpon .eq. 1) jm1=jm1*exp(-nu)

        return
 3000 continue
c
        if(d .gt. thresh4) goto 3100
c       z is in the third intermediate regime: its absolute value is
c       between 20 and 40. act accordingly.
c
        nu=3*(z/2)**toth
c 
        cd=done/nu
c
        m=34
        call abramm1p(cm1p3,m,cd,jm1)
        jm1=dc*sqrt(3/nu)*jm1
        if (ifexpon .eq. 1) jm1=jm1*exp(-nu)

        return
 3100 continue
c
        if(d .gt. thresh5) goto 3200
c       z is in the fourth intermediate regime: its absolute value is
c       between 40 and 80. act accordingly.
c
        nu=3*(z/2)**toth
c 
        cd=done/nu
c
        m=32
        call abramm1p(cm1p4,m,cd,jm1)
        jm1=dc*sqrt(3/nu)*jm1
        if (ifexpon .eq. 1) jm1=jm1*exp(-nu)

        return
 3200 continue
        
        if(d .gt. thresh6) goto 3300
c       z is in the fourth intermediate regime: its absolute value is
c       between 80 and 160. act accordingly.
c
        nu=3*(z/2)**toth
c 
        cd=done/nu
c
        m=32
        call abramm1p(cm1p5,m,cd,jm1)
        jm1=dc*sqrt(3/nu)*jm1
        if (ifexpon .eq. 1) jm1=jm1*exp(-nu)

        return
 3300 continue
        if(d .gt. thresh7) goto 3400
c       z is in the fourth intermediate regime: its absolute value is
c       between 160 and 320. act accordingly.
c
        nu=3*(z/2)**toth
c 
        cd=done/nu
c
        m=30
        call abramm1p(cm1p6,m,cd,jm1)
        jm1=dc*sqrt(3/nu)*jm1
        if (ifexpon .eq. 1) jm1=jm1*exp(-nu)

        return
 3400 continue
c
c        z is either in the local regime or the asymptotic one.
c        if it is in the local regime - act accordingly.
c
        if(d .ge. 102400.d0) goto 4000
        call abramm1series(z,jm1,ifexpon)
        return
c
c        z is in the asymptotic regime. act accordingly.
c
 4000 continue
        call abramm1asym(z,jm1,ifexpon)
        return
        end
c
c
c
c
c
